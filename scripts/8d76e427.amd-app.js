var requirejs,require,define;(function(global){function isFunction(a){return ostring.call(a)==="[object Function]"}function isArray(a){return ostring.call(a)==="[object Array]"}function each(a,b){if(a){var c;for(c=0;c<a.length;c+=1)if(a[c]&&b(a[c],c,a))break}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1;c-=1)if(a[c]&&b(a[c],c,a))break}}function hasProp(a,b){return hasOwn.call(a,b)}function eachProp(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){if(c||!hasProp(a,e))d&&typeof b!="string"?(a[e]||(a[e]={}),mixin(a[e],b,c,d)):a[e]=b}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeContextModuleFunc(a,b,c){return function(){var d=aps.call(arguments,0),e;return c&&isFunction(e=d[d.length-1])&&(e.__requireJsBuild=!0),d.push(b),a.apply(null,d)}}function addRequireMethods(a,b,c){each([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(d){var e=d[1]||d[0];a[d[0]]=b?makeContextModuleFunc(b[e],c):function(){var a=contexts[defContextName];return a[e].apply(a,arguments)}})}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function p(a){var b,c;for(b=0;a[b];b+=1){c=a[b];if(c===".")a.splice(b,1),b-=1;else if(c===".."){if(b===1&&(a[2]===".."||a[0]===".."))break;b>0&&(a.splice(b-1,2),b-=2)}}}function q(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,q=b&&b.split("/"),r=q,s=g.map,t=s&&s["*"];a&&a.charAt(0)==="."&&(b?(g.pkgs[b]?r=q=[b]:r=q.slice(0,q.length-1),a=r.concat(a.split("/")),p(a),e=g.pkgs[d=a[0]],a=a.join("/"),e&&a===d+"/"+e.main&&(a=d)):a.indexOf("./")===0&&(a=a.substring(2)));if(c&&(q||t)&&s){h=a.split("/");for(i=h.length;i>0;i-=1){k=h.slice(0,i).join("/");if(q)for(j=q.length;j>0;j-=1){f=s[q.slice(0,j).join("/")];if(f){f=f[k];if(f){l=f,m=i;break}}}if(l)break;!n&&t&&t[k]&&(n=t[k],o=i)}!l&&n&&(l=n,m=o),l&&(h.splice(0,m,l),a=h.join("/"))}return a}function r(a){isBrowser&&each(scripts(),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===d.contextName)return b.parentNode.removeChild(b),!0})}function s(a){var b=g.paths[a];if(b&&isArray(b)&&b.length>1)return r(a),b.shift(),d.undef(a),d.require([a]),!0}function t(a,b,c,e){var f,g,h,i=a?a.indexOf("!"):-1,j=null,l=b?b.name:null,o=a,p=!0,r="";return a||(p=!1,a="_@r"+(m+=1)),i!==-1&&(j=a.substring(0,i),a=a.substring(i+1,a.length)),j&&(j=q(j,l,e),g=k[j]),a&&(j?g&&g.normalize?r=g.normalize(a,function(a){return q(a,l,e)}):r=q(a,l,e):(r=q(a,l,e),f=d.nameToUrl(r))),h=j&&!g&&!c?"_unnormalized"+(n+=1):"",{prefix:j,name:r,parentMap:b,unnormalized:!!h,url:f,originalName:o,isDefine:p,id:(j?j+"!"+r:r)+h}}function u(a){var b=a.id,c=h[b];return c||(c=h[b]=new d.Module(a)),c}function v(a,b,c){var d=a.id,e=h[d];hasProp(k,d)&&(!e||e.defineEmitComplete)?b==="defined"&&c(k[d]):u(a).on(b,c)}function w(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=h[b];c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function x(){globalDefQueue.length&&(apsp.apply(j,[j.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function y(a,b,c){var e=a&&a.map,f=makeContextModuleFunc(c||d.require,e,b);return addRequireMethods(f,d,e),f.isBrowser=isBrowser,f}function z(a){delete h[a],each(o,function(b,c){if(b.map.id===a)return o.splice(c,1),b.defined||(d.waitCount-=1),!0})}function A(a,b){var c=a.map.id,d=a.depMaps,e;if(!a.inited)return;return b[c]?a:(b[c]=!0,each(d,function(a){var d=a.id,f=h[d];if(!f)return;return!f.inited||!f.enabled?(e=null,delete b[c],!0):e=A(f,mixin({},b))}),e)}function B(a,b,c){var d=a.map.id,f=a.depMaps;if(!a.inited||!a.map.isDefine)return;return b[d]?k[d]:(b[d]=a,each(f,function(f){var g=f.id,i=h[g],j;if(e[g])return;if(i){if(!i.inited||!i.enabled){c[d]=!0;return}j=B(i,b,c),c[g]||a.defineDepById(g,j)}}),a.check(!0),k[d])}function C(a){a.check()}function D(){var a,c,e,i,j=g.waitSeconds*1e3,k=j&&d.startTime+j<(new Date).getTime(),l=[],m=!1,n=!0;if(b)return;b=!0,eachProp(h,function(b){a=b.map,c=a.id;if(!b.enabled)return;if(!b.error)if(!b.inited&&k)s(c)?(i=!0,m=!0):(l.push(c),r(c));else if(!b.inited&&b.fetched&&a.isDefine){m=!0;if(!a.prefix)return n=!1}});if(k&&l.length)return e=makeError("timeout","Load timeout for modules: "+l,null,l),e.contextName=d.contextName,w(e);n&&(each(o,function(a){if(a.defined)return;var b=A(a,{}),c={};b&&(B(b,c,{}),eachProp(c,C))}),eachProp(h,C)),(!k||i)&&m&&(isBrowser||isWebWorker)&&!f&&(f=setTimeout(function(){f=0,D()},50)),b=!1}function E(a){u(t(a[0],null,!0)).init(a[1],a[2])}function F(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function G(a){var b=a.currentTarget||a.srcElement;return F(b,d.onScriptLoad,"load","onreadystatechange"),F(b,d.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}var b,c,d,e,f,g={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},h={},i={},j=[],k={},l={},m=1,n=1,o=[];return e={require:function(a){return y(a)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports=k[a.map.id]={}},module:function(a){return a.module={id:a.map.id,uri:a.map.url,config:function(){return g.config&&g.config[a.map.id]||{}},exports:k[a.map.id]}}},c=function(a){this.events=i[a.id]||{},this.map=a,this.shim=g.shim[a.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},c.prototype={init:function(a,b,c,d){d=d||{};if(this.inited)return;this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.depMaps.rjsSkipMap=a.rjsSkipMap,this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check()},defineDepById:function(a,b){var c;return each(this.depMaps,function(b,d){if(b.id===a)return c=d,!0}),this.defineDep(c,b)},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(this.fetched)return;this.fetched=!0,d.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();y(this,!0)(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()}))},load:function(){var a=this.map.url;l[a]||(l[a]=!0,d.load(this.map.id,a))},check:function(a){if(!this.enabled||this.enabling)return;var b,c,e=this.map.id,f=this.depExports,g=this.exports,i=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(i)){if(this.events.error)try{g=d.execCb(e,i,f,g)}catch(j){b=j}else g=d.execCb(e,i,f,g);this.map.isDefine&&(c=this.module,c&&c.exports!==undefined&&c.exports!==this.exports?g=c.exports:g===undefined&&this.usingExports&&(g=this.exports));if(b)return b.requireMap=this.map,b.requireModules=[this.map.id],b.requireType="define",w(this.error=b)}else g=i;this.exports=g,this.map.isDefine&&!this.ignore&&(k[e]=g,req.onResourceLoad&&req.onResourceLoad(d,this.map,this.depMaps)),delete h[e],this.defined=!0,d.waitCount-=1,d.waitCount===0&&(o=[])}this.defining=!1,a||this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var a=this.map,b=a.id,c=t(a.prefix,null,!1,!0);v(c,"defined",bind(this,function(c){var e,f,i,j=this.map.name,k=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){c.normalize&&(j=c.normalize(j,function(a){return q(a,k,!0)})||""),f=t(a.prefix+"!"+j,this.map.parentMap,!1,!0),v(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),i=h[f.id],i&&(this.events.error&&i.on("error",bind(this,function(a){this.emit("error",a)})),i.enable());return}e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(h,function(a){a.map.id.indexOf(b+"_unnormalized")===0&&z(a.map.id)}),w(a)}),e.fromText=function(a,b){var c=useInteractive;c&&(useInteractive=!1),u(t(a)),req.exec(b),c&&(useInteractive=!0),d.completeLoad(a)},c.load(a.name,y(a.parentMap,!0,function(a,b,c){return a.rjsSkipMap=!0,d.require(a,b,c)}),e,g)})),d.enable(c,this),this.pluginMaps[c.id]=c},enable:function(){this.enabled=!0,this.waitPushed||(o.push(this),d.waitCount+=1,this.waitPushed=!0),this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,f,g;if(typeof a=="string"){a=t(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap),this.depMaps[b]=a,g=e[a.id];if(g){this.depExports[b]=g(this);return}this.depCount+=1,v(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&v(a,"error",this.errback)}c=a.id,f=h[c],!e[c]&&f&&!f.enabled&&d.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=h[a.id];b&&!b.enabled&&d.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),a==="error"&&delete this.events[a]}},d={config:g,contextName:a,registry:h,defined:k,urlFetched:l,waitCount:0,defQueue:j,Module:c,makeModuleMap:t,configure:function(a){a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/");var b=g.pkgs,c=g.shim,e=g.paths,f=g.map;mixin(g,a,!0),g.paths=mixin(e,a.paths,!0),a.map&&(g.map=mixin(f||{},a.map,!0,!0)),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),a.exports&&!a.exports.__buildReady&&(a.exports=d.makeShimExports(a.exports)),c[b]=a}),g.shim=c),a.packages&&(each(a.packages,function(a){var c;a=typeof a=="string"?{name:a}:a,c=a.location,b[a.name]={name:a.name,location:c||a.name,main:(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),g.pkgs=b),eachProp(h,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=t(b))}),(a.deps||a.callback)&&d.require(a.deps||[],a.callback)},makeShimExports:function(a){var b;return typeof a=="string"?(b=function(){return getGlobal(a)},b.exports=a,b):function(){return a.apply(global,arguments)}},requireDefined:function(a,b){return hasProp(k,t(a,b,!1,!0).id)},requireSpecified:function(a,b){return a=t(a,b,!1,!0).id,hasProp(k,a)||hasProp(h,a)},require:function(b,c,e,f){var g,h,i,l,m;if(typeof b=="string")return isFunction(c)?w(makeError("requireargs","Invalid require call"),e):req.get?req.get(d,b,c):(g=b,f=c,i=t(g,f,!1,!0),h=i.id,hasProp(k,h)?k[h]:w(makeError("notloaded",'Module name "'+h+'" has not been loaded yet for context: '+a)));e&&!isFunction(e)&&(f=e,e=undefined),c&&!isFunction(c)&&(f=c,c=undefined),x();while(j.length){m=j.shift();if(m[0]===null)return w(makeError("mismatch","Mismatched anonymous define() module: "+m[m.length-1]));E(m)}return l=u(t(null,f)),l.init(b,c,e,{enabled:!0}),D(),d.require},undef:function(a){x();var b=t(a,null,!0),c=h[a];delete k[a],delete l[b.url],delete i[a],c&&(c.events.defined&&(i[a]=c.events),z(a))},enable:function(a,b){var c=h[a.id];c&&u(a).enable()},completeLoad:function(a){var b,c,d,e=g.shim[a]||{},f=e.exports&&e.exports.exports;x();while(j.length){c=j.shift();if(c[0]===null){c[0]=a;if(b)break;b=!0}else c[0]===a&&(b=!0);E(c)}d=h[a];if(!b&&!k[a]&&d&&!d.inited){if(g.enforceDefine&&(!f||!getGlobal(f))){if(s(a))return;return w(makeError("nodefine","No define call for "+a,null,[a]))}E([a,e.deps||[],e.exports])}D()},toUrl:function(a,b){var c=a.lastIndexOf("."),e=null;return c!==-1&&(e=a.substring(c,a.length),a=a.substring(0,c)),d.nameToUrl(q(a,b&&b.id,!0),e)},nameToUrl:function(a,b){var c,d,e,f,h,i,j,k,l;if(req.jsExtRegExp.test(a))k=a+(b||"");else{c=g.paths,d=g.pkgs,h=a.split("/");for(i=h.length;i>0;i-=1){j=h.slice(0,i).join("/"),e=d[j],l=c[j];if(l){isArray(l)&&(l=l[0]),h.splice(0,i,l);break}if(e){a===e.name?f=e.location+"/"+e.main:f=e.location,h.splice(0,i,f);break}}k=h.join("/"),k+=b||(/\?/.test(k)?"":".js"),k=(k.charAt(0)==="/"||k.match(/^[\w\+\.\-]+:/)?"":g.baseUrl)+k}return g.urlArgs?k+((k.indexOf("?")===-1?"?":"&")+g.urlArgs):k},load:function(a,b){req.load(d,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if(a.type==="load"||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=G(a);d.completeLoad(b.id)}},onScriptError:function(a){var b=G(a);if(!s(b.id))return w(makeError("scripterror","Script error",a,[b.id]))}}}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(a){if(a.readyState==="interactive")return interactiveScript=a}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.0.5",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return!isArray(a)&&typeof a!="string"&&(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=contexts[g],e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),addRequireMethods(req),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(a){throw a},req.load=function(a,b,c){var d=a&&a.config||{},e;if(isBrowser)return e=d.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),e.type=d.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e.setAttribute("data-requirecontext",a.contextName),e.setAttribute("data-requiremodule",b),e.attachEvent&&!(e.attachEvent.toString&&e.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,e.attachEvent("onreadystatechange",a.onScriptLoad)):(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)),e.src=c,currentlyAddingScript=e,baseElement?head.insertBefore(e,baseElement):head.appendChild(e),currentlyAddingScript=null,e;isWebWorker&&(importScripts(c),a.completeLoad(b))},isBrowser&&eachReverse(scripts(),function(a){head||(head=a.parentNode),dataMain=a.getAttribute("data-main");if(dataMain)return cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0}),define=function(a,b,c){var d,e;typeof a!="string"&&(c=b,b=a,a=null),isArray(b)||(c=b,b=[]),!b.length&&isFunction(c)&&c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(c.length===1?["require"]:["require","exports","module"]).concat(b)),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),function(){var defineNodeImages=function(){console.log("node images loaded");if(typeof a=="undefined")var a={};return typeof a.Images=="undefined"&&(a.Images={}),a.Images.player1={},a.Images.player2={},a.Images.player3={},a.Images.player4={},a.Images.platform={},a.Images.spawn={},a.Images.powerup={},a.Images.ropeAnchor={},a.Images.mallow={},a.Images.mallowFiller={},a.Images.pickups={},a.Images},defineBrowserImages=function(){console.log("browser images loaded");if(typeof a=="undefined")var a={};return typeof a.Images=="undefined"&&(a.Images={}),a.Images.player1=document.getElementById("playerSprite1"),a.Images.player2=document.getElementById("playerSprite2"),a.Images.player3=document.getElementById("playerSprite3"),a.Images.player4=document.getElementById("playerSprite4"),a.Images.platform=document.getElementById("main_platform"),a.Images.spawn=document.getElementById("spawn_platform"),a.Images.powerup=document.getElementById("powerup_spawn"),a.Images.ropeAnchor=document.getElementById("rope_anchor"),a.Images.mallow=document.getElementById("marshmallowSprites"),a.Images.mallowFiller=document.getElementById("mallow"),a.Images.pickups=document.getElementById("pickupSprites"),a.Images};console.log("loading images"),typeof define!="undefined"?define("mduel/images",[],defineBrowserImages):typeof module!="undefined"&&(module.exports=defineNodeImages());var defineSpritesheet=function(){console.log("spriteSheet loaded");if(typeof a=="undefined")var a={};return typeof a.Spritesheet=="undefined"&&(a.Spritesheet={}),a.Spritesheet.spritesheet=function(a){var b={};return b.sprites=a.sprites,b.width=a.width,b.height=a.height,b.getOffset=function(a){var c=b.sprites[a];return c?{x:c.x||0,y:(c.y||0)*b.height,width:b.width,height:b.height}:null},b},a.Spritesheet};typeof define!="undefined"?define("mduel/spritesheet",[],defineSpritesheet):typeof module!="undefined"&&(module.exports=defineSpritesheet());var defineSprites=function(a){console.log("sprites loaded");if(typeof b=="undefined")var b={};return typeof b.Sprites=="undefined"&&(b.Sprites={}),b.Spritesheet=a,b.Sprites.player=b.Spritesheet.spritesheet({width:64,height:64,sprites:{stand:{x:0,y:0},run_1:{x:0,y:1},run_2:{x:0,y:2},run_3:{x:0,y:3},run_4:{x:0,y:4},crouched:{x:0,y:5},crouching:{x:0,y:6},roll_1:{x:0,y:7},roll_2:{x:0,y:8},roll_3:{x:0,y:9},roll_4:{x:0,y:10},jump_1:{x:0,y:11},jump_2:{x:0,y:12},jump_3:{x:0,y:13},jump_4:{x:0,y:14},jump_5:{x:0,y:15},jump_6:{x:0,y:16},jump_7:{x:0,y:17},run_jump_1:{x:0,y:18},run_jump_2:{x:0,y:19},run_jump_3:{x:0,y:20},stand_fall:{x:0,y:21},roll_back_1:{x:0,y:22},roll_back_2:{x:0,y:23},roll_back_3:{x:0,y:24},roll_back_4:{x:0,y:25},knock_forward_1:{x:0,y:26},knock_forward_2:{x:0,y:27},knock_back_1:{x:0,y:28},knock_back_2:{x:0,y:29},gun_shoot_1:{x:0,y:30},gun_shoot_2:{x:0,y:31},grenade_toss_1:{x:0,y:32},grenade_toss_2:{x:0,y:33},puck_toss_1:{x:0,y:34},puck_toss_2:{x:0,y:35},parachute:{x:0,y:36},unknown_27:{x:0,y:37},unknown_28:{x:0,y:38},climb_1:{x:0,y:39},climb_2:{x:0,y:40},climb_3:{x:0,y:41},climb_4:{x:0,y:42},climb_5:{x:0,y:43},stand_victory_1:{x:0,y:44},stand_victory_2:{x:0,y:45},rope_victory_1:{x:0,y:46},rope_victory_2:{x:0,y:47},disintegrate_1:{x:0,y:48},disintegrate_2:{x:0,y:49},disintegrate_3:{x:0,y:50},disintegrate_4:{x:0,y:51},disintegrate_5:{x:0,y:52},disintegrate_6:{x:0,y:53},vaporize_1:{x:0,y:54},vaporize_2:{x:0,y:55},vaporize_3:{x:0,y:56},vaporize_4:{x:0,y:57},taunt_1:{x:0,y:58},taunt_2:{x:0,y:59},taunt_3:{x:0,y:60},taunt_4:{x:0,y:61},flex_1:{x:0,y:62},flex_2:{x:0,y:63},magnet_1:{x:0,y:64},magnet_2:{x:0,y:65},empty:{x:0,y:66},trapped:{x:0,y:67}}}),b.Sprites.pit=b.Spritesheet.spritesheet({width:32,height:32,sprites:{pit0:{x:0,y:0},pit1:{x:0,y:1},pit2:{x:0,y:2},pit3:{x:0,y:3}}}),b.Sprites.pickups=b.Spritesheet.spritesheet({width:32,height:32,sprites:{bubble1:{x:0,y:0},bubble2:{x:0,y:1},bubble3:{x:0,y:2},skull:{x:0,y:3},lightning:{x:0,y:4},invisibility:{x:0,y:5},mine:{x:0,y:6},gun:{x:0,y:7},explode:{x:0,y:8},boot:{x:0,y:9},grenade:{x:0,y:10},puck:{x:0,y:11},parachute:{x:0,y:12},unknown_1:{x:0,y:13},unknown_2:{x:0,y:14},magnet:{x:0,y:15},unknown_3:{x:0,y:16},shield:{x:0,y:17},drop:{x:0,y:18},unknown_4:{x:0,y:19},corner_tl:{x:0,y:20},corner_tr:{x:0,y:21},corner_br:{x:0,y:22},puck_1:{x:0,y:23},puck_2:{x:0,y:24},grenade_1:{x:0,y:25},grenade_2:{x:0,y:26},bigdrop:{x:0,y:27}}}),b.Sprites};typeof define!="undefined"?define("mduel/sprites",["mduel/spritesheet"],defineSprites):typeof module!="undefined"&&(module.exports=defineSprites(require("./spritesheet")));var defineAnimation=function(a){console.log("animation loaded");if(typeof b=="undefined")var b={};return typeof b.Animation=="undefined"&&(b.Animation={}),b.Sprites=a,b.Animation.animation=function(a){var b={};return b.frames=a.frames,b.sprites=a.data,b.loop=a.loop,b.finished=!1,b.frameDuration=a.frames[0].time,b.frameIndex=a.startFrame||0,b.animate=function(a){b.frameDuration-=a,b.frameDuration<=0&&!b.finished&&(b.frameIndex++,b.frameIndex==b.frames.length&&(b.loop?b.frameIndex=0:(b.finished=!0,b.frameIndex=b.frames.length-1)),b.frameDuration=b.frames[b.frameIndex].time)},b.isFinished=function(){return b.finished},b.getSprite=function(){return b.sprites.getOffset(b.frames[b.frameIndex].sprite)},b},b.Animation};typeof define!="undefined"?define("mduel/animation",["mduel/sprites"],defineAnimation):typeof module!="undefined"&&(module.exports=defineAnimation(require("./sprites")));var defineAnimations=function(a,b){console.log("animations loaded");if(typeof c=="undefined")var c={};return typeof c.Animations=="undefined"&&(c.Animations={}),c.Sprites=a,c.Animation=b,c.Animations.pit=function(a){return c.Animation.animation({frames:[{sprite:"pit0",time:2500},{sprite:"pit1",time:2500},{sprite:"pit2",time:2500},{sprite:"pit3",time:2500}],data:c.Sprites.pit,loop:!0,startFrame:a})},c.Animations.bubble=function(){return c.Animation.animation({frames:[{sprite:"bubble1",time:250},{sprite:"bubble2",time:250},{sprite:"bubble3",time:250}],data:c.Sprites.pickups,loop:!0})},c.Animations.skull=function(){return c.Animation.animation({frames:[{sprite:"skull",time:1e7}],data:c.Sprites.pickups})},c.Animations.lightning=function(){return c.Animation.animation({frames:[{sprite:"lightning",time:1e7}],data:c.Sprites.pickups})},c.Animations.invisibility=function(){return c.Animation.animation({frames:[{sprite:"invisibility",time:1e7}],data:c.Sprites.pickups})},c.Animations.mine=function(){return c.Animation.animation({frames:[{sprite:"mine",time:1e7}],data:c.Sprites.pickups})},c.Animations.gun=function(){return c.Animation.animation({frames:[{sprite:"gun",time:1e7}],data:c.Sprites.pickups})},c.Animations.explode=function(){return c.Animation.animation({frames:[{sprite:"explode",time:1e7}],data:c.Sprites.pickups})},c.Animations.knockForward=function(){return c.Animation.animation({frames:[{sprite:"knock_forward_1",time:15},{sprite:"knock_forward_2",time:15}],data:c.Sprites.player})},c.Animations.knockBack=function(){return c.Animation.animation({frames:[{sprite:"knock_back_1",time:15},{sprite:"knock_back_2",time:15}],data:c.Sprites.player})},c.Animations.disintegrate=function(){return c.Animation.animation({frames:[{sprite:"disintegrate_1",time:75},{sprite:"disintegrate_2",time:75},{sprite:"disintegrate_3",time:75},{sprite:"disintegrate_4",time:75},{sprite:"disintegrate_5",time:75},{sprite:"disintegrate_6",time:75}],data:c.Sprites.player})},c.Animations.stand=function(){return c.Animation.animation({frames:[{sprite:"stand",time:1e7}],data:c.Sprites.player})},c.Animations.run=function(){return c.Animation.animation({frames:[{sprite:"run_1",time:75},{sprite:"run_2",time:75},{sprite:"run_3",time:75},{sprite:"run_4",time:75}],loop:!0,data:c.Sprites.player})},c.Animations.roll=function(){return c.Animation.animation({frames:[{sprite:"crouching",time:75},{sprite:"roll_1",time:75},{sprite:"roll_2",time:75},{sprite:"roll_3",time:75},{sprite:"roll_4",time:75},{sprite:"crouched",time:1}],data:c.Sprites.player})},c.Animations.crouching=function(){return c.Animation.animation({frames:[{sprite:"crouching",time:75},{sprite:"crouched",time:1}],data:c.Sprites.player})},c.Animations.crouch=function(){return c.Animation.animation({frames:[{sprite:"crouched",time:1}],data:c.Sprites.player})},c.Animations.uncrouching=function(){return c.Animation.animation({frames:[{sprite:"crouched",time:75},{sprite:"crouching",time:1}],data:c.Sprites.player})},c.Animations.standJump=function(){return c.Animation.animation({frames:[{sprite:"jump_2",time:75},{sprite:"jump_3",time:75},{sprite:"jump_4",time:75},{sprite:"jump_5",time:75},{sprite:"jump_6",time:75},{sprite:"jump_7",time:75}],data:c.Sprites.player})},c.Animations.runJump=function(){return c.Animation.animation({frames:[{sprite:"run_jump_1",time:150},{sprite:"run_jump_2",time:150},{sprite:"run_jump_3",time:150}],data:c.Sprites.player})},c.Animations.climbing=function(){return c.Animation.animation({frames:[{sprite:"climb_1",time:75},{sprite:"climb_2",time:75},{sprite:"climb_3",time:75},{sprite:"climb_4",time:75}],loop:!0,data:c.Sprites.player})},c.Animations.rope=function(){return c.Animation.animation({frames:[{sprite:"climb_5",time:1}],data:c.Sprites.player})},c.Animations.standFall=function(){return c.Animation.animation({frames:[{sprite:"stand_fall",time:1}],data:c.Sprites.player})},c.Animations.empty=function(){return c.Animation.animation({frames:[{sprite:"empty",time:1}],data:c.Sprites.player})},c.Animations};typeof define!="undefined"?define("mduel/animations",["mduel/sprites","mduel/animation"],defineAnimations):typeof module!="undefined"&&(module.exports=defineAnimations(require("./sprites"),require("./animation")));var defineUtil=function(){console.log("util loaded");if(typeof a=="undefined")var a={};return typeof a.Util=="undefined"&&(a.Util={}),a.Util.sum=function(a,b){var c=0;for(var d=0,e=a.length;d<e;d++)c+=b(a[d]);return c},a.Util.where=function(a,b){var c=new Array;for(var d=0,e=a.length;d<e;d++)b(a[d])&&c.push(a[d]);return c},a.Util.colliding=function(a,b){return a.x<b.x+b.width&&a.x+a.width>b.x&&a.y<b.y+b.height&&a.y+a.height>b.y},a.Util.removeAt=function(a,b){return a.splice(b,1),a},a.Util};typeof define!="undefined"?define("mduel/util",[],defineUtil):typeof module!="undefined"&&(module.exports=defineUtil());var seedrandomgenerator=function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;e.S=[],e.c=[],f||(a=[f++]);while(g<c)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(b){var d=e.S,f=k(e.i+1),g=d[f],h=k(e.j+g),i=d[h];d[f]=i,d[h]=g;var j=d[k(g+i)];while(--b)f=k(f+1),g=d[f],h=k(h+g),i=d[h],d[f]=i,d[h]=g,j=j*c+d[k(g+i)];return e.i=f,e.j=h,j},e.g(c)}function i(a,b,c,d,e){c=[],e=typeof a;if(b&&e=="object")for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+(e!="string"?"\0":"")}function j(a,b,c,d){a+="",c=0;for(d=0;d<a.length;d++)b[k(d)]=k((c^=b[k(d)]*19)+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(l,m){var n=[],o;return l=j(i(m?[l,a]:arguments.length?l:[(new Date).getTime(),a,window],3),n),o=new h(n),j(o.S,a),b.random=function(){var b=o.g(d),h=g,i=0;while(b<e)b=(b+i)*c,h*=c,i=o.g(1);while(b>=f)b/=2,h/=2,i>>>=1;return(b+i)/h},l},g=b.pow(c,d),e=b.pow(2,e),f=e*2,j(b.random(),a)};if(typeof define!="undefined")define("vendor/seedrandom",[],function(){var a={pow:Math.pow,random:Math.random};return seedrandomgenerator([],a,256,6,52),a});else if(typeof module!="undefined"){var math={pow:Math.pow,random:Math.random};seedrandomgenerator([],math,256,6,52),module.exports=math}else typeof window!="undefined"&&seedrandomgenerator([],Math,256,6,52);var defineStage=function(a,b,c,d){d.seedrandom("the dark lords");var e=d.random;console.log("stage loaded");if(typeof f=="undefined")var f={};return typeof f.Stage=="undefined"&&(f.Stage={}),f.Images=a,f.Animations=b,f.Util=c,f.Stage.stage=function(a){var b={},c=f.Stage.generateStage();return b.platforms=c.platforms,b.ropes=c.ropes,b.pit=[f.Animations.pit(0),f.Animations.pit(1),f.Animations.pit(2),f.Animations.pit(3)],b.update=function(a){},b.draw=function(a,c,d,e){a.save(),a.translate(d,e/2-f.Images.platform.width/2),a.rotate(90*(Math.PI/180)),a.drawImage(f.Images.powerup,0,0),a.restore(),a.save(),a.translate(0,208),a.rotate(270*(Math.PI/180)),a.drawImage(f.Images.powerup,0,0),a.restore(),a.drawImage(f.Images.powerup,d/2-f.Images.platform.width/2,0);for(var g=0,h=b.platforms.length;g<h;g++){var i=b.platforms[g].isSpawn?f.Images.spawn:f.Images.platform;a.drawImage(i,b.platforms[g].x,b.platforms[g].y)}for(var g=0,h=b.ropes.length;g<h;g++){var j=b.ropes[g];a.drawImage(f.Images.ropeAnchor,j.anchor.x,j.anchor.y),a.moveTo(j.ropeStart.x,j.ropeStart.y),a.lineTo(j.ropeEnd.x,j.ropeEnd.y)}a.strokeStyle="#926100",a.stroke();for(var g=0,h=b.pit.length;g<h;g++)b.pit[g].animate(c);for(var g=0,k=d;g<k;g+=32*b.pit.length)for(var l=0,h=b.pit.length;l<h;l++){var m=b.pit[l].getSprite();a.drawImage(f.Images.mallow,m.x,m.y,m.width,m.height,g+l*m.width,e-(m.height+22),m.width,m.height),a.drawImage(f.Images.mallowFiller,g+l*32,e-m.height)}},b},f.Stage.generateStage=function(){var a=[f.Stage.generateTopLevel(),f.Stage.generateLevel(18),f.Stage.generateLevel(18),f.Stage.generateLevel(18)],b=new Array,c=64,d=80;for(var e=0;e<a.length;e++){var g=a[e];for(var h=0;h<g.length;h++)g[h]&&b.push({x:h*32+32,y:e*c+d,isSpawn:!1})}for(var i=0;i<4;i++)b.push({x:32*i+48,y:4*c+d,isSpawn:!0});for(var i=0;i<4;i++)b.push({x:32*(i+13)+48,y:4*c+d,isSpawn:!0});var j=f.Stage.generateRopes(a,18);return{platforms:b,ropes:j}},f.Stage.generateTopLevel=function(){var a=new Array;return a[0]={width:2,isPlatform:!1},a[1]={width:4,isPlatform:!0},a[2]={width:6,isPlatform:!1},a[3]={width:4,isPlatform:!0},a[4]={width:2,isPlatform:!1},f.Stage.convertLevel(a)},f.Stage.generateLevel=function(a){var b=7,c=2,d=2,g=1,h=new Array,i=Math.floor(e()*2),j=function(a){return a.width};while(f.Util.sum(h,j)<a){var k=i?c:g,l=i?b:d,m=Math.floor(e()*(l+1-k))+k;h.push({width:m,isPlatform:i}),i=!i;var n=f.Util.sum(h,j);n>a&&(h[h.length-1].width-=n-a,h[h.length-1].isPlatform=!1)}return f.Stage.convertLevel(h)},f.Stage.convertLevel=function(a){var b=new Array;for(var c=0,d=a.length;c<d;c++)for(var e=0,f=a[c].width;e<f;e++)b.push(a[c].isPlatform);return b},f.Stage.generateRopes=function(a,b){var c=new Array;c.push({x:4,y:0,ropeLength:5}),c.push({x:14,y:0,ropeLength:5});var d=new Array,f=new Array;for(var g=1;g<b;g++){var h=new Array;a[1][g]&&a[2][g]&&h.push({x:g,y:1,ropeLength:2}),a[2][g]&&a[3][g]&&h.push({x:g,y:2,ropeLength:2}),a[1][g]&&a[3][g]&&h.push({x:g,y:1,ropeLength:3});if(h.length>0){var i=Math.floor(e()*h.length),j=h[i];g<4?d.push(j):g>4&&g!=14&&f.push(j)}}if(d.length>0){var i=Math.floor(e()*d.length);c.push(d[i])}if(f.length>0){var k=Math.min(f.length,Math.floor(e()*3)+1),l=0;while(l<k){var i=Math.floor(e()*f.length);c.push(f[i]),l++}}var m=26,n=new Array,o=10,p=5,q=8;for(var g=0,r=c.length;g<r;g++){var s=c[g],t=s.x==4||s.x==14?25:41;s.x=s.x*32+t,s.y=s.y*64+m,n.push({anchor:{x:s.x,y:s.y},ropeStart:{x:s.x+p,y:s.y+o},ropeEnd:{x:s.x+p,y:s.y+s.ropeLength*64-(q+1)}})}return n},f.Stage};typeof define!="undefined"?define("mduel/stage",["mduel/images","mduel/animations","mduel/util","vendor/seedrandom"],defineStage):typeof module!="undefined"&&(module.exports=defineStage(require("./images"),require("./animations"),require("./util"),require("../vendor/seedrandom")));var defineKeyboard=function(){console.log("keyboard loaded");if(typeof a=="undefined")var a={};return typeof a.Keyboard=="undefined"&&(a.Keyboard={}),a.Keyboard.keyDown=function(b){a.Game=require("mduel/game");var c=a.Keyboard.getKeyName(b.keyCode);if(c&&a.Game.state=="game")for(var d=0,e=a.Keyboard.playerKeys.length;d<e;d++)if(a.Keyboard.playerKeys[d][c]){var f=a.Keyboard.playerKeys[d][c],g=(new Date).valueOf();a.Keyboard.playerKeyStates[d][f].pressed=!0,a.Keyboard.playerKeyStates[d][f].eventTime=g,a.Keyboard.playerKeyStates[d].lastKey.name=f,a.Keyboard.playerKeyStates[d].lastKey.pressed=!0,a.Keyboard.playerKeyStates[d].lastKey.eventTime=g,a.Game.localPlayers.length>d&&a.Game.localPlayers[d].keyDown&&a.Game.localPlayers[d].keyDown(a.Keyboard.playerKeyStates[d])}},a.Keyboard.keyUp=function(b){a.Game=require("mduel/game");var c=a.Keyboard.getKeyName(b.keyCode);if(c&&a.Game.state=="game")for(var d=0,e=a.Keyboard.playerKeys.length;d<e;d++)if(a.Keyboard.playerKeys[d][c]){var f=a.Keyboard.playerKeys[d][c],g=(new Date).valueOf();a.Keyboard.playerKeyStates[d][f].pressed=!1,a.Keyboard.playerKeyStates[d][f].eventTime=g,a.Keyboard.playerKeyStates[d].lastKey.name=f,a.Keyboard.playerKeyStates[d].lastKey.pressed=!1,a.Keyboard.playerKeyStates[d].lastKey.eventTime=g,a.Game.localPlayers.length>d&&a.Game.localPlayers[d].keyUp&&a.Game.localPlayers[d].keyUp(a.Keyboard.playerKeyStates[d])}},a.Keyboard.playerKeys=[{left:"left",right:"right",up:"up",down:"down",enter:"action"},{a:"left",d:"right",w:"up",s:"down",q:"action"}],a.Keyboard.playerKeyStates=[{lastKey:{name:undefined,pressed:!1,eventTime:0},up:{pressed:!1,eventTime:0},down:{pressed:!1,eventTime:0},left:{pressed:!1,eventTime:0},right:{pressed:!1,eventTime:0},action:{pressed:!1,eventTime:0}},{lastKey:{name:undefined,pressed:!1,eventTime:0},up:{pressed:!1,eventTime:0},down:{pressed:!1,eventTime:0},left:{pressed:!1,eventTime:0},right:{pressed:!1,eventTime:0},action:{pressed:!1,eventTime:0}}],a.Keyboard.keyNames={37:"left",38:"up",39:"right",40:"down",65:"a",83:"s",68:"d",87:"w",13:"enter",73:"i",74:"j",75:"k",76:"l",85:"u",81:"q"},a.Keyboard.getKeyName=function(b){var c=null;return a.Keyboard.keyNames[""+b]&&(c=a.Keyboard.keyNames[""+b]),c},a.Keyboard};typeof define!="undefined"?define("mduel/keyboard",[],defineKeyboard):typeof module!="undefined"&&(module.exports=defineKeyboard());var definePlayerState=function(a,b){console.log("playerState loaded");if(typeof c=="undefined")var c={};return typeof c.PlayerState=="undefined"&&(c.PlayerState={}),c.Animations=a,c.Keyboard=b,c.PlayerState.playerState=function(a){var b={};return b.player=a.player,b.states={stand:{animation:"stand",keyUp:function(a){},keyDown:function(a){if(a.lastKey.name=="left"&&a.left.pressed&&!a.right.pressed)b.player.setVelocityX(-b.player.get("RUN_SPEED")),b.player.setFlip(!0),b.setState("run");else if(a.lastKey.name=="right"&&a.right.pressed&&!a.left.pressed)b.player.setVelocityX(b.player.get("RUN_SPEED")),b.player.setFlip(!1),b.setState("run");else if(a.lastKey.name=="down"&&!a.right.pressed&&!a.right.pressed){var c=b.player.isOnRope();c?(b.player.setPositionX(c.ropeStart.x-32),b.player.setVelocityY(b.player.get("CLIMB_SPEED")),b.setState("climbing")):b.setState("crouching")}else if(a.lastKey.name=="up"&&!a.right.pressed&&!a.right.pressed){var c=b.player.isOnRope();c?(b.player.setPositionX(c.ropeStart.x-32),b.player.setVelocityY(-b.player.get("CLIMB_SPEED")),b.setState("climbing")):(b.player.setVelocityY(-10),b.setState("standJump"))}}},run:{animation:"run",update:function(a){b.player.isOnPlatform()||b.setState("fall")},keyUp:function(a){!a.left.pressed&&!a.right.pressed?(b.player.setVelocityX(0),b.setState("stand")):!a.left.pressed&&a.right.pressed?(b.player.setVelocityX(b.player.get("RUN_SPEED")),b.player.setFlip(!1)):a.left.pressed&&!a.right.pressed&&(b.player.setVelocityX(-b.player.get("RUN_SPEED")),b.player.setFlip(!0))},keyDown:function(a){a.lastKey.name=="down"?a.left.pressed||a.right.pressed?b.setState("roll"):b.setState("crouch"):a.lastKey.name=="up"&&(b.player.setVelocityY(-10),b.setState("runJump"))}},standJump:{animation:"standJump",update:function(a){b.player.getVelocityY()<b.player.get("MAX_FALL_SPEED")&&b.player.changeVelocityY(1);if(b.player.getVelocityY()>=0){var c=b.player.isOnPlatform();c&&(b.player.setPositionY(c.y-56),b.player.setVelocityY(0),b.setState("stand"))}}},runJump:{animation:"runJump",update:function(a){b.player.getVelocityY()<b.player.get("MAX_FALL_SPEED")&&b.player.changeVelocityY(1);if(b.player.getVelocityY()>=0){var d=b.player.isOnPlatform();if(b.player.getPositionY()>=320)b.player.setVelocity(0,0),b.player.setPositionY(320),b.setState("disintegrate");else if(d){b.player.setVelocityY(0),b.player.setPositionY(d.y-56);var e=c.Keyboard.playerKeyStates[b.player.id];if(!e.right.pressed&&!e.left.pressed)b.player.setVelocityX(0),b.setState("stand");else{if(e.right.pressed&&!e.left.pressed&&b.player.getVelocityX()<0||e.left.pressed&&!e.right.pressed&&b.player.getVelocityX()>0)b.player.setFlip(!b.player.getFlip()),b.player.setVelocityX(-1*b.player.getVelocityX());b.setState("run")}}}}},crouching:{animation:"crouching",update:function(a){if(b.currentAnimation.isFinished()){var d=c.Keyboard.playerKeyStates[b.player.id];d.down.pressed?b.setState("crouch"):b.setState("uncrouching")}}},crouch:{animation:"crouch",keyUp:function(a){a.down.pressed||b.setState("uncrouching")}},roll:{animation:"roll",update:function(a){if(!b.player.isOnPlatform())b.setState("fall");else if(b.currentAnimation.isFinished()){b.player.setVelocityX(0);var d=c.Keyboard.playerKeyStates[b.player.id];d.down.pressed?b.setState("crouch"):b.setState("uncrouching")}}},knockForward:{animation:"knockForward",update:function(a){b.currentAnimation.isFinished()&&b.setState("fall")}},knockBack:{animation:"knockBack",update:function(a){b.currentAnimation.isFinished()&&b.setState("fall")}},uncrouching:{animation:"uncrouching",update:function(a){if(b.currentAnimation.isFinished()){var d=c.Keyboard.playerKeyStates[b.player.id];d.left.pressed&&(!d.right.pressed||d.left.eventTime>d.right.eventTime)?(b.player.setFlip(!0),b.player.setVelocityX(-b.player.get("RUN_SPEED")),b.setState("run")):d.right.pressed&&(!d.left.pressed||d.right.eventTime>d.left.eventTime)?(b.player.setFlip(!1),b.player.setVelocityX(b.player.get("RUN_SPEED")),b.setState("run")):b.setState("stand")}}},climbing:{animation:"climbing",update:function(a){var c=b.player.isOnRope();c||b.player.changePositionY(-b.player.getVelocityY())},keyUp:function(a){!a.up.pressed&&!a.down.pressed&&(b.player.setVelocityY(0),b.setState("rope"))},keyDown:function(a){a.lastKey.name=="left"?(b.player.setVelocityX(-b.player.get("RUN_SPEED")),b.setState("fall")):a.lastKey.name=="right"&&(b.player.setVelocityX(b.player.get("RUN_SPEED")),b.setState("fall"))}},rope:{animation:"rope",keyUp:function(a){},keyDown:function(a){a.lastKey.name=="up"?(b.player.setVelocityY(-b.player.get("CLIMB_SPEED")),b.setState("climbing")):a.lastKey.name=="down"?(b.player.setVelocityY(b.player.get("CLIMB_SPEED")),b.setState("climbing")):a.lastKey.name=="left"?(b.player.setVelocityX(-b.player.get("RUN_SPEED")),b.setState("fall")):a.lastKey.name=="right"&&(b.player.setVelocityX(b.player.get("RUN_SPEED")),b.setState("fall"))}},ropeFall:{animation:"stand",update:function(a){b.player.getVelocityY()<b.player.get("MAX_FALL_SPEED")&&b.player.changeVelocityY(1);if(b.player.getPositionY()>=320)b.player.setVelocity(0,0),b.player.setPositionY(320),b.setState("disintegrate");else{var c=b.player.isOnPlatform();c&&(b.player.setVelocity(0,0),b.setState("stand"))}}},fall:{animation:"standFall",update:function(a){b.player.getVelocityY()<b.player.get("MAX_FALL_SPEED")&&b.player.changeVelocityY(1);if(b.player.getPositionY()>=320)b.player.setVelocity(0,0),b.player.setPositionY(320),b.setState("disintegrate");else{var c=b.player.isOnPlatform();c&&(b.player.setVelocityY(0),b.player.setPositionY(c.y-56),b.setState("runJump")),b.player.getVelocityX()<0?b.player.setFlip(!0):b.player.getVelocityX()>0&&b.player.setFlip(!1)}}},disintegrate:{animation:"disintegrate",update:function(a){b.currentAnimation.isFinished()&&b.setState("dead")}},dead:{animation:"empty"}},b.setState=function(a){console.log("setState",a),b.states[a]&&(b.currentState=b.states[a],b.currentAnimation=c.Animations[b.currentState.animation]())},b.update=function(a){b.currentState&&b.currentState.update&&b.currentState.update(a)},b.setState(b.player.get("state")),b},c.PlayerState};typeof define!="undefined"?define("mduel/playerState",["mduel/animations","mduel/keyboard"],definePlayerState):typeof module!="undefined."&&(module.exports=definePlayerState(require("./animations"),require("./keyboard"))),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.4.3";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b){return x.isEmpty(b)?[]:x.filter(a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;d.computed>g&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(b||x.identity);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;e>c.call(d,a[h])?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return y(a,function(a){x.isArray(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(i.apply(d,arguments))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=Array(b),d=0;b>d;d++)c[d]=x.pluck(a,""+d);return c},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(this instanceof d){E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}return a.apply(b,c.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return 0==b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},x.debounce=function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return 0>=a?b():function(){return 1>--a?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==b+"";case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;c.push(a),d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=a.length,h=g==b.length)for(;g--&&(h=F(a[g],b[g],c,d)););}else{var i=a.constructor,k=b.constructor;if(i!==k&&!(x.isFunction(i)&&i instanceof i&&x.isFunction(k)&&k instanceof k))return!1;for(var l in a)if(x.has(a,l)&&(g++,!(h=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(h){for(l in b)if(x.has(b,l)&&!(g--))break;h=!g}}return c.pop(),d.pop(),h};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!!a&&1===a.nodeType},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!x.has(a,"callee")}),x.isFunction=function(a){return"function"==typeof a},x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(a),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+(0|Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=""+ ++I;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){c=x.defaults({},c,x.templateSettings);var d=RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(L,function(a){return"\\"+K[a]}),c&&(f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(f+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),g&&(f+="';\n"+g+"\n__p+='"),e=h+b.length,b}),f+="';\n",c.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=Function(c.variable||"obj","_",f)}catch(h){throw h.source=f,h}if(b)return g(b,x);var i=function(a){return g.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+f+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(a){return function(){return a._}}(this)),function(){var a=this,b=a.Backbone,c=[],d=c.push,e=c.slice,f=c.splice,g;g="undefined"!=typeof exports?exports:a.Backbone={},g.VERSION="0.9.10";var h=a._;!h&&"undefined"!=typeof require&&(h=require("underscore")),g.$=a.jQuery||a.Zepto||a.ender,g.noConflict=function(){return a.Backbone=b,this},g.emulateHTTP=!1,g.emulateJSON=!1;var i=/\s+/,j=function(a,b,c,d){if(!c)return!0;if("object"==typeof c)for(var e in c)a[b].apply(a,[e,c[e]].concat(d));else{if(!i.test(c))return!0;c=c.split(i),e=0;for(var f=c.length;e<f;e++)a[b].apply(a,[c[e]].concat(d))}},k=function(a,b){var c,d=-1,e=a.length;switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);break;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0]);break;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},c=g.Events={on:function(a,b,c){return!j(this,"on",a,[b,c])||!b?this:(this._events||(this._events={}),(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this}),this)},once:function(a,b,c){if(!j(this,"once",a,[b,c])||!b)return this;var d=this,e=h.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c),this},off:function(a,b,c){var d,e,f,g,i,k,l,m;if(!this._events||!j(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;g=a?[a]:h.keys(this._events),i=0;for(k=g.length;i<k;i++)if(a=g[i],d=this._events[a]){f=[];if(b||c){l=0;for(m=d.length;l<m;l++)e=d[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&f.push(e)}this._events[a]=f}return this},trigger:function(a){if(!this._events)return this;var b=e.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&k(c,b),d&&k(d,arguments),this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=h.uniqueId("l"));return d[e]=a,a.on(b,"object"==typeof b?this:c,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,"object"==typeof b?this:c,this),!b&&!c&&delete d[a._listenerId];else{"object"==typeof b&&(c=this);for(var e in d)d[e].off(b,c,this);this._listeners={}}return this}}};c.bind=c.on,c.unbind=c.off,h.extend(g,c);var l=g.Model=function(a,b){var c,d=a||{};this.cid=h.uniqueId("c"),this.attributes={},b&&b.collection&&(this.collection=b.collection),b&&b.parse&&(d=this.parse(d,b)||{});if(c=h.result(this,"defaults"))d=h.defaults({},d,c);this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};h.extend(l.prototype,c,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return g.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,f,g,i,j,k;if(null==a)return this;"object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={});if(!this._validate(e,c))return!1;f=c.unset,g=c.silent,a=[],i=this._changing,this._changing=!0,i||(this._previousAttributes=h.clone(this.attributes),this.changed={}),k=this.attributes,j=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],h.isEqual(k[d],b)||a.push(d),h.isEqual(j[d],b)?delete this.changed[d]:this.changed[d]=b,f?delete k[d]:k[d]=b;if(!g){a.length&&(this._pending=!0),b=0;for(d=a.length;b<d;b++)this.trigger("change:"+a[b],this,k[a[b]],c)}if(i)return this;if(!g)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._changing=this._pending=!1,this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes,e;for(e in a)h.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success;return a.success=function(a,c,d){if(!a.set(a.parse(c,d),d))return!1;b&&b(a,c,d)},this.sync("read",this,a)},save:function(a,b,c){var d,e,f=this.attributes;return null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,d&&(!c||!c.wait)&&!this.set(d,c)?!1:(c=h.extend({validate:!0},c),this._validate(d,c)?(d&&c.wait&&(this.attributes=h.extend({},f,d)),void 0===c.parse&&(c.parse=!0),e=c.success,c.success=function(a,b,c){a.attributes=f;var g=a.parse(b,c);c.wait&&(g=h.extend(d||{},g));if(h.isObject(g)&&!a.set(g,c))return!1;e&&e(a,b,c)},a=this.isNew()?"create":c.patch?"patch":"update","patch"===a&&(c.attrs=d),a=this.sync(a,this,c),d&&c.wait&&(this.attributes=f),a):!1)},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(a,b,e){(e.wait||a.isNew())&&d(),c&&c(a,b,e)};if(this.isNew())return a.success(this,null,a),!1;var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||B();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return!this.validate||!this.validate(this.attributes,a)},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,b||{}),!1):!0}});var m=g.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,h.extend({silent:!0},b))};h.extend(m.prototype,c,{model:l,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return g.sync.apply(this,arguments)},add:function(a,b){a=h.isArray(a)?a.slice():[a],b||(b={});var c,e,g,i,j,k,l,m,n,o;l=[],m=b.at,n=this.comparator&&null==m&&0!=b.sort,o=h.isString(this.comparator)?this.comparator:null,c=0;for(e=a.length;c<e;c++)(g=this._prepareModel(i=a[c],b))?(j=this.get(g))?b.merge&&(j.set(i===g?g.attributes:i,b),n&&!k&&j.hasChanged(o)&&(k=!0)):(l.push(g),g.on("all",this._onModelEvent,this),this._byId[g.cid]=g,null!=g.id&&(this._byId[g.id]=g)):this.trigger("invalid",this,i,b);l.length&&(n&&(k=!0),this.length+=l.length,null!=m?f.apply(this.models,[m,0].concat(l)):d.apply(this.models,l)),k&&this.sort({silent:!0});if(b.silent)return this;c=0;for(e=l.length;c<e;c++)(g=l[c]).trigger("add",g,this,b);return k&&this.trigger("sort",this,b),this},remove:function(a,b){a=h.isArray(a)?a.slice():[a],b||(b={});var c,d,e,f;c=0;for(d=a.length;c<d;c++)if(f=this.get(a[c]))delete this._byId[f.id],delete this._byId[f.cid],e=this.indexOf(f),this.models.splice(e,1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f);return this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:this.length},b)),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){if(null!=a)return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[a.id||a.cid||a[this._idAttr]||a]},at:function(a){return this.models[a]},where:function(a){return h.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return a||(a={}),h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return h.invoke(this.models,"get",a)},update:function(a,b){b=h.extend({add:!0,merge:!0,remove:!0},b),b.parse&&(a=this.parse(a,b));var c,d,e,f,g=[],i=[],j={};h.isArray(a)||(a=a?[a]:[]);if(b.add&&!b.remove)return this.add(a,b);d=0;for(e=a.length;d<e;d++)c=a[d],f=this.get(c),b.remove&&f&&(j[f.cid]=!0),(b.add&&!f||b.merge&&f)&&g.push(c);if(b.remove){d=0;for(e=this.models.length;d<e;d++)c=this.models[d],j[c.cid]||i.push(c)}return i.length&&this.remove(i,b),g.length&&this.add(g,b),this},reset:function(a,b){b||(b={}),b.parse&&(a=this.parse(a,b));for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return b.previousModels=this.models.slice(),this._reset(),a&&this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success;return a.success=function(a,c,d){a[d.update?"update":"reset"](c,d),b&&b(a,c,d)},this.sync("read",this,a)},create:function(a,b){b=b?h.clone(b):{};if(!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(a,b){if(a instanceof l)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=new this.model(a,b);return c._validate(a,b)?c:!1},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=h.isFunction(b)?b:function(a){return a.get(b)};return h.sortedIndex(this.models,a,d,c)}}),h.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(a){m.prototype[a]=function(){var b=e.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}}),h.each(["groupBy","countBy","sortBy"],function(a){m.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var n=g.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},o=/\((.*?)\)/g,p=/(\(\?)?:\w+/g,q=/\*\w+/g,r=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(n.prototype,c,{initialize:function(){},route:function(a,b,c){return h.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),g.history.route(a,h.bind(function(d){d=this._extractParameters(a,d),c&&c.apply(this,d),this.trigger.apply(this,["route:"+b].concat(d)),this.trigger("route",b,d),g.history.trigger("route",this,b,d)},this)),this},navigate:function(a,b){return g.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes)for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])},_routeToRegExp:function(a){return a=a.replace(r,"\\$&").replace(o,"(?:$1)?").replace(p,function(a,b){return b?a:"([^/]+)"}).replace(q,"(.*?)"),RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var s=g.History=function(){this.handlers=[],h.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},t=/^[#\/]|\s+$/g,u=/^\/+|\/+$/g,v=/msie [\w.]+/,w=/\/$/;s.started=!1,h.extend(s.prototype,c,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(w,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(t,"")},start:function(a){if(s.started)throw Error("Backbone.history has already been started");s.started=!0,this.options=h.extend({},{root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),a=this.getFragment();var b=document.documentMode,b=v.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b);this.root=("/"+this.root+"/").replace(u,"/"),b&&this._wantsHashChange&&(this.iframe=g.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a)),this._hasPushState?g.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?g.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=a,a=this.location,b=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=this.getHash().replace(t,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search));if(!this.options.silent)return this.loadUrl()},stop:function(){g.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),s.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return h.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!s.started)return!1;if(!b||!0===b)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}}),g.history=new s;var x=g.View=function(a){this.cid=h.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,z="model collection el id attributes className tagName events".split(" ");h.extend(x.prototype,c,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof g.$?a:g.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(a||(a=h.result(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];h.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(y),e=d[1],d=d[2],c=h.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.on(e,c):this.$el.on(e,d,c)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a)),h.extend(this,h.pick(a,z)),this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var a=h.extend({},h.result(this,"attributes"));this.id&&(a.id=h.result(this,"id")),this.className&&(a["class"]=h.result(this,"className")),a=g.$("<"+h.result(this,"tagName")+">").attr(a),this.setElement(a,!1)}}});var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=A[a];h.defaults(c||(c={}),{emulateHTTP:g.emulateHTTP,emulateJSON:g.emulateJSON});var e={type:d,dataType:"json"};c.url||(e.url=h.result(b,"url")||B()),null==c.data&&b&&("create"===a||"update"===a||"patch"===a)&&(e.contentType="application/json",e.data=JSON.stringify(c.attrs||b.toJSON(c))),c.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===d)){e.type="POST",c.emulateJSON&&(e.data._method=d);var f=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d);if(f)return f.apply(this,arguments)}}"GET"!==e.type&&!c.emulateJSON&&(e.processData=!1);var i=c.success;c.success=function(a){i&&i(b,a,c),b.trigger("sync",b,a,c)};var j=c.error;return c.error=function(a){j&&j(b,a,c),b.trigger("error",b,a,c)},a=c.xhr=g.ajax(h.extend(e,c)),b.trigger("request",b,a,c),a},g.ajax=function(){return g.$.ajax.apply(g.$,arguments)},l.extend=m.extend=n.extend=x.extend=s.extend=function(a,b){var c=this,d;d=a&&h.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)},h.extend(d,c,b);var e=function(){this.constructor=d};return e.prototype=c.prototype,d.prototype=new e,a&&h.extend(d.prototype,a),d.__super__=c.prototype,d};var B=function(){throw Error('A "url" property or function must be specified')}}.call(this),define("backbone",function(a){return function(){return a.Backbone}}(this));var defineMovingObject=function(a,b){console.log("player loaded");if(typeof c=="undefined")var c={};return typeof c.Player=="undefined"&&(c.MovingObject={}),c.MovingObject=b.Model.extend({defaults:{x:0,y:0,vx:0,vy:0,bx:0,by:0,bw:0,bh:0},initialize:function(){},getPositionX:function(){return this.get("x")},getPositionY:function(){return this.get("y")},getVelocityX:function(){return this.get("vx")},getVelocityY:function(){return this.get("vy")},setPositionX:function(a){this.set("x",a)},setPositionY:function(a){this.set("y",a)},setPosition:function(a,b){this.set({x:a,y:b})},setVelocityX:function(a){this.set("vx",a)},setVelocityY:function(a){this.set("vy",a)},setVelocity:function(a,b){this.set({vx:a,vy:b})},change:function(a,b){this.set(a,this.get(a)+b)},changePositionX:function(a){return this.change("x",a)},changePositionY:function(a){return this.change("y",a)},changeVelocityX:function(a){return this.change("vx",a)},changeVelocityY:function(a){return this.change("vy",a)}}),c.MovingObject};typeof define!="undefined"?define("mduel/movingObject",["underscore","backbone"],defineMovingObject):typeof module!="undefined."&&(module.exports=defineMovingObject(require("underscore"),require("backbone")));var memoize=function(a,b){var c={};return function(){var d=b.apply(this,arguments);return hasOwnProperty.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},calculateBoundingBox=memoize(function(a,b,c,d,e,f){var g=e,h=f,i=0,j=0,k=document.createElement("canvas");k.height=a.height,k.width=a.width;var l=k.getContext("2d");l.drawImage(a,c,d,e,f,0,0,e,f);var m=l.getImageData(0,0,a.width,a.height);for(var c=0;c<m.width;c++)for(var d=0;d<m.height;d++){var n=(c+d*m.width)*4;m.data[n+3]&&(c<g&&(g=c),d<h&&(h=d),c>i&&(i=c),d>j&&(j=d))}return b?{x:e-g-(i-g),y:h,width:i-g,height:j-h}:{x:g,y:h,width:i-g,height:j-h}},function(a,b,c,d,e,f){return""+a+b+c+d+e+f}),definePlayer=function(a,b,c,d,e){console.log("player loaded");if(typeof f=="undefined")var f={};return typeof f.Player=="undefined"&&(f.Player={}),f.Images=a,f.PlayerState=b,f.Stage=c,f.Util=d,f.MovingObject=e,f.Player.Player=f.MovingObject.extend({defaults:_.extend({location:"platform",flip:!1,state:"stand",spriteImage:f.Images.player1,id:0,RUN_SPEED:3.2,CLIMB_SPEED:2.5,MAX_FALL_SPEED:12},f.MovingObject.prototype.defaults),initialize:function(){var a=f.PlayerState.playerState({player:this});this.set("playerState",a)},getBoundingBox:function(){var a=this.get("spriteImage"),b=this.get("flip"),c=this.get("playerState").currentAnimation.getSprite(),d=calculateBoundingBox(a,b,c.x,c.y,c.width,c.height);return{x:this.getPositionX()+d.x,y:this.getPositionY()+d.y,width:d.width,height:d.height}},draw:function(a,b){var c={x:this.getPositionX(),y:this.getPositionY()};this.get("playerState").currentAnimation.animate(b);var d=this.get("playerState").currentAnimation.getSprite();this.get("flip")&&(a.save(),c.x=-c.x-d.width,a.transform(-1,0,0,1,0,0)),a.drawImage(this.get("spriteImage"),d.x,d.y,d.width,d.height,c.x,c.y,d.width,d.height),this.get("flip")&&a.restore()},update:function(a){var b=this.getVelocityX(),c=this.getVelocityY();b!==0&&this.changePositionX(b),c!==0&&this.changePositionY(c),this.updateLocation(),this.get("playerState").update(a)},keyUp:function(a){this.get("playerState").currentState.keyUp&&this.get("playerState").currentState.keyUp(a)},keyDown:function(a){this.get("playerState").currentState.keyDown&&this.get("playerState").currentState.keyDown(a)},updateLocation:function(){this.location=="platform"&&(this.isOnPlatform()||(this.location="air"))},isOnPlatform:function(){f.Game=require("mduel/game");var a=undefined,b=this.getPositionX()+32,c=function(a){return b>=a.x&&b<=a.x+32},d=f.Util.where(f.Game.stage.platforms,c),e=this.getPositionY()+56,g=function(a){var b=a.y-e;return b<=12&&b>=-8},h=f.Util.where(d,g);return h.length>0&&(a=h[0]),a},isOnRope:function(){f.Game=require("mduel/game");var a=undefined,b=this.getPositionX()+32,c=function(a){return b>=a.ropeStart.x-4&&b<=a.ropeStart.x+4},d=f.Util.where(f.Game.stage.ropes,c);return d.length==1&&d[0].ropeEnd.y>=this.getPositionY()+56&&d[0].ropeStart.y<=this.getPositionY()+14&&(a=d[0]),a},getFlip:function(){return this.get("flip")},setFlip:function(a){this.set("flip",a)}}),f.Player};typeof define!="undefined"?define("mduel/player",["mduel/images","mduel/playerState","mduel/stage","mduel/util","mduel/movingObject"],definePlayer):typeof module!="undefined."&&(module.exports=definePlayer(require("./images"),require("./playerState"),require("./stage"),require("./util"),require("mduel/movingObject")));var definePickups=function(a,b,c,d){console.log("pickups loaded");if(typeof e=="undefined")var e={};return typeof e.Pickups=="undefined"&&(e.Pickups={}),e.Animations=a,e.Images=b,e.Util=c,e.Pickups.pickup=function(a){var b={};return b.firebase=a,b.bubble=e.Animations.bubble(),b.image=e.Animations.skull(),b.remove=function(){a.remove()},b.get=function(b){var c=null;return a.child(b).once("value",function(a){c=a.val()}),c},b.set=function(b,c){var d;a.once("value",function(a){d=a.val()}),a.transaction(function(a){var d=b.split("/"),e=a;for(var f=0;f<d.length-1;f++)e=e[d[f]];return e[d[d.length-1]]=c,a},function(a,b,c){a||console.log("set transaction failure",b.val(),c)})},b.change=function(b,c){var d;a.once("value",function(a){d=a.val()}),a.transaction(function(a){var d=b.split("/"),e=a;for(var f=0;f<d.length-1;f++)e=e[d[f]];return e[d[d.length-1]]+=c,a},function(a,b,c){a||console.log("change transaction failure",b.val(),c)})},b.update=function(a){var c=b.get("velocity");b.change("position/x",c.x),b.change("position/y",c.y);var d=b.get("position");d.x<0?b.set("velocity/x",Math.abs(c.x)):d.x>610&&b.set("velocity/x",-Math.abs(c.x)),d.y<0?b.set("velocity/y",Math.abs(c.y)):d.y>340&&b.set("velocity/y",-Math.abs(c.y))},b.drawAnimation=function(a,b,c,d){c.animate(b);var f=c.getSprite();a.drawImage(e.Images.pickups,f.x,f.y,f.width,f.height,d.x,d.y,f.width,f.height)},b.draw=function(a,c){var d=b.get("position");if(!d)return;b.drawAnimation(a,c,b.bubble,d),b.drawAnimation(a,c,b.image,d)},b},e.Pickups.pickups=function(a){var b={};b.firebase=a,b.items=[];var c=function(a){console.log("onPickupAdded",a.val()),b.items.push(new e.Pickups.pickup(a.ref()))},d=function(a){console.log("onPickupRemoved",a.val()),delete b.items[a.name()]};return a.on("child_added",c),a.on("child_removed",d),b.update=function(a){for(var c=0;c<b.items.length;c++)b.items[c].update(a)},b.draw=function(a,c){for(var d=0;d<b.items.length;d++)b.items[d].draw(a,c)},b.handlePlayerCollisions=function(a){for(var c=0;c<b.items.length;c++){var d=b.items[c],f=d.getBoundingBox();for(var g=0;g<a.length;g++){var h=a[g],i=h.getBoundingBox();if(e.Util.colliding(f,i)){h.set("pickup",d.get("type")),d.remove();break}}}},b.create=function(){var b=Math.random()+.8,c=3.6-b;b=Math.random()<.5?b:-b,c=Math.random()<.5?c:-c,a.push({position:{x:304,y:20},velocity:{x:b,y:c},type:"explode"})},b},e.Pickups};typeof define!="undefined"?define("mduel/pickups",["mduel/animations","mduel/images","mduel/util","underscore"],definePickups):typeof module!="undefined"&&(module.exports=definePickups(require("../mduel/animations"),require("../mduel/images"),require("../mduel/util"),require("underscore")));var defineGame=function(a,b,c,d,e,f,g){console.log("game loaded");if(typeof h=="undefined")var h={};return typeof h.Game=="undefined"&&(h.Game={}),h.Player=b,h.Images=c,h.Pickups=d,h.Stage=a,h.Keyboard=e,h.Util=f,h.Game.startGame=function(a){h.Game.debug=!1,h.Game.framerate=30,h.Game.lastFrameDrawn=(new Date).valueOf(),h.Game.state="game",h.Game.localPlayers=[],h.Game.remotePlayers=[],h.Game.pickups=h.Pickups.pickups(a.child("pickups")),h.Game.stage=h.Stage.stage(),h.Game.addLocalPlayer(),h.Game.addLocalPlayer(),h.Game.addLocalPlayer(),h.Game.addLocalPlayer(),window.onkeydown=h.Keyboard.keyDown,window.onkeyup=h.Keyboard.keyUp,setInterval(h.Game.gameLoop,1e3/h.Game.framerate)},h.Game.generateStartPosition=function(){var a=h.Game.stage.platforms,b=Math.floor(Math.random()*(new Date).getTime()),c=a[b%a.length];return{x:c.x-16,y:c.y-56}},h.Game.addLocalPlayer=function(a){var b=[h.Images.player1,h.Images.player2,h.Images.player3,h.Images.player4],c=h.Game.generateStartPosition(),d=new h.Player.Player({x:c.x,y:c.y,spriteImage:b[h.Game.localPlayers.length],id:h.Game.localPlayers.length});h.Game.localPlayers.push(d)},h.Game.gameLoop=function(){var a=(new Date).valueOf(),b=a-h.Game.lastFrameDrawn;h.Game.lastFrameDrawn=a,h.Game.handleCollisions(b),h.Game.update(b),h.Game.draw(b)},h.Game.update=function(a){h.Game.stage.update(a);for(var b=0,c=h.Game.localPlayers.length;b<c;b++)h.Game.localPlayers[b].update(a)},h.Game.draw=function(a){var b=document.getElementById("game"),c=b.getContext("2d");c.clearRect(0,0,b.width,b.height);if(h.Game.state=="game"){h.Game.stage.draw(c,a,b.width,b.height);for(var d=0,e=h.Game.remotePlayers.length;d<e;d++){var f=h.Game.remotePlayers[d];f.draw(c,a)}for(var d=0,e=h.Game.localPlayers.length;d<e;d++){var f=h.Game.localPlayers[d];f.draw(c,a)}h.Game.pickups.draw(c,a)}if(h.Game.debug){var g=function(a){var b=a.getBoundingBox();c.strokeStyle="red",c.strokeRect(b.x,b.y,b.width,b.height)};for(var d=0,e=h.Game.remotePlayers.length;d<e;d++)g(h.Game.remotePlayers[d]);for(var d=0,e=h.Game.localPlayers.length;d<e;d++)g(h.Game.localPlayers[d]);c.fillStyle="#f00",c.font="arial 30px sans-serif",c.fillText(h.Game.debugText||"",5,10)}},h.Game.handleWallCollisions=function(a,b){var c=document.getElementById("game"),d=b.getBoundingBox(),e={x:-100,y:0,width:100,height:c.height},f={x:c.width,y:0,width:100,height:c.height};if(h.Util.colliding(e,d)){if(b.getVelocityX()>0)return;b.setFlip(!b.getFlip()),b.setVelocityX(-1*b.getVelocityX())}else if(h.Util.colliding(f,d)){if(b.getVelocityX()<0)return;b.setFlip(!b.getFlip()),b.setVelocityX(-1*b.getVelocityX())}},h.Game.handlePlayerCollisions=function(a,b,c){if(b===c)return;if(!h.Util.colliding(b.getBoundingBox(),c.getBoundingBox()))return;console.log("collision")},h.Game.handleCollisions=function(a){for(var b=0;b<h.Game.localPlayers.length;b++){var c=h.Game.localPlayers[b];h.Game.handleWallCollisions(a,c);for(var d=b+1;d<h.Game.localPlayers.length;d++){var e=h.Game.localPlayers[d];h.Game.handlePlayerCollisions(a,c,e)}for(var d=0;d<h.Game.remotePlayers.length;d++){var e=h.Game.remotePlayers[d];h.Game.handlePlayerCollisions(a,c,e)}}},h.Game};typeof define!="undefined"?define("mduel/game",["mduel/stage","mduel/player","mduel/images","mduel/pickups","mduel/keyboard","mduel/util","underscore"],defineGame):typeof module!="undefined"&&(module.exports=defineGame(require("./stage"),require("./player"),require("./images"),require("./pickups"),require("./keyboard"),require("./util"),require("underscore"))),function(){function g(a){throw a}function aa(a){return function(){return this[a]}}function p(a){return function(){return a}}function ca(){}function da(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function s(a){return a!==i}function ea(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function u(a){return"string"==typeof a}function fa(a){return"number"==typeof a}function ga(a){var b=typeof a;return"object"==b&&a!=m||"function"==b}function ha(a,b,c){return a.call.apply(a.bind,arguments)}function ia(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function w(a,b,c){return w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia,w.apply(m,arguments)}function ja(a,b){function c(){}c.prototype=b.prototype,a.Od=b.prototype,a.prototype=new c}function ka(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}g(Error("Invalid JSON string: "+a))}function la(){this.Yb=i}function ma(a,b,c){switch(typeof b){case"string":na(b,c);break;case"number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case"boolean":c.push(b);break;case"undefined":c.push("null");break;case"object":if(b==m){c.push("null");break}if("array"==da(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],ma(a,a.Yb?a.Yb.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{"),d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),na(f,c),c.push(":"),ma(a,a.Yb?a.Yb.call(b,f,e):e,c),d=","));c.push("}");break;case"function":break;default:g(Error("Unknown type: "+typeof b))}}function na(a,b){b.push('"',a.replace(pa,function(a){if(a in oa)return oa[a];var b=a.charCodeAt(0),c="\\u";return 16>b?c+="000":256>b?c+="00":4096>b&&(c+="0"),oa[a]=c+b.toString(16)}),'"')}function qa(a){return"undefined"!=typeof JSON&&s(JSON.parse)?JSON.parse(a):ka(a)}function y(a){if("undefined"!=typeof JSON&&s(JSON.stringify))a=JSON.stringify(a);else{var b=[];ma(new la,a,b),a=b.join("")}return a}function ra(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,z(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320)),128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function A(a,b,c,d){var e;d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c),e&&g(Error(a+" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+"."))}function B(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:sa.assert(n,"errorPrefix_ called with argumentNumber > 4.  Need to update it?")}return a+" failed: "+(d+" argument ")}function D(a,b,c,d){(!d||s(c))&&"function"!=da(c)&&g(Error(B(a,b,d)+"must be a valid function."))}function ta(a,b,c){s(c)&&(!ga(c)||c===m)&&g(Error(B(a,b,k)+"must be a valid context object."))}function xa(a){return u(a)&&0!==a.length&&!va.test(a)}function ya(a,b,c){(!c||s(b))&&za(B(a,1,c),b)}function za(a,b,c,d){c||(c=0),d||(d=[]),s(b)||g(Error(a+"contains undefined"+Aa(d))),"function"==da(b)&&g(Error(a+"contains a function"+Aa(d))),Ba(b)&&g(Error(a+"contains "+b.toString()+Aa(d))),1e3<c&&g(new TypeError(a+"contains a cyclic object value ("+d.slice(0,100).join(".")+"...)")),u(b)&&b.length>10485760/3&&10485760<ua.Pd.Nd(b).length&&g(Error(a+"contains a string greater than 10485760 utf8 bytes"+Aa(d)+" ('"+b.substring(0,50)+"...')"));if(ga(b))for(var e in b)b.hasOwnProperty(e)&&(".priority"!==e&&".value"!==e&&!xa(e)&&g(Error(a+"contains an invalid key ("+e+")"+Aa(d)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')),d.push(e),za(a,b[e],c+1,d),d.pop())}function Aa(a){return 0==a.length?"":" in property "+a.join(".")}function Ca(a,b,c,d){(!d||s(c))&&c!==m&&!fa(c)&&!u(c)&&g(Error(B(a,b,d)+"must be a valid firebase priority (null or a string.)"))}function Da(a,b,c){if(!c||s(b))switch(b){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:g(Error(B(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".'))}}function Ea(a,b){s(b)&&!xa(b)&&g(Error(B(a,2,k)+'must be a valid firebase key (non-empty string, not containing ".", "#", "$", "/", "[", or "]").'))}function Fa(a,b){(!u(b)||0===b.length||wa.test(b))&&g(Error(B(a,1,n)+'must be a non-empty string and can\'t contain ".", "#", "$", "[", or "]".'))}function Ga(a,b){".info"===E(b)&&g(Error(a+" failed: Can't modify data under /.info/"))}function F(a,b,c,d,e,f,h){this.n=a,this.path=b,this.va=c,this.aa=Ha.test(d)?Number(d):d,this.na=e,this.ta=Ha.test(f)?Number(f):f,this.Ra=h,s(this.aa)&&s(this.ta)&&s(this.va)&&g("Query: Can't combine startAt(), endAt(), and limit().")}function Ja(a){var b={};return s(a.aa)&&(b.sp=a.aa),s(a.na)&&(b.sn=a.na),s(a.ta)&&(b.ep=a.ta),s(a.Ra)&&(b.en=a.Ra),s(a.va)&&(b.l=a.va),s(a.aa)&&s(a.na)&&a.aa===m&&a.na===m&&(b.vf="l"),b}function Ia(a,b,c){var d={};return b&&c?(d.cancel=b,D(a,3,d.cancel,k),d.V=c,ta(a,4,d.V)):b&&("object"==typeof b&&b!==m?d.V=b:"function"==typeof b?d.cancel=b:g(Error(B(a,3,k)+"must either be a cancel callback or a context object."))),d}function G(a,b){for(var c in a)b.call(i,a[c],c,a)}function H(a){if(a instanceof H)return a;if(1==arguments.length){this.j=a.split("/");for(var b=0,c=0;c<this.j.length;c++)0<this.j[c].length&&(this.j[b]=this.j[c],b++);this.j.length=b,this.T=0}else this.j=arguments[0],this.T=arguments[1]}function E(a){return a.T>=a.j.length?m:a.j[a.T]}function La(a){var b=a.T;return b<a.j.length&&b++,new H(a.j,b)}function Oa(a,b){var c=E(a);if(c===m)return b;if(c===E(b))return Oa(La(a),La(b));g("INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")")}function Pa(){this.children={},this.Cb=0,this.value=m}function Qa(a,b,c){this.Hb=a?a:"",this.qb=b?b:m,this.m=c?c:new Pa}function I(a,b){for(var c=b instanceof H?b:new H(b),d=a,e;(e=E(c))!==m;)d=new Qa(e,d,e in d.m.children?d.m.children[e]:new Pa),c=La(c);return d}function J(a,b){z("undefined"!=typeof b),a.m.value=b,Ra(a)}function Sa(a,b,c,d){c&&!d&&b(a),a.z(function(a){Sa(a,b,k,d)}),c&&d&&b(a)}function Ta(a,b,c){for(a=c?a:a.parent();a!==m;){if(b(a))return k;a=a.parent()}return n}function Ra(a){if(a.qb!==m){var b=a.qb,c=a.Hb,d=a.e(),e=c in b.m.children;d&&e?(delete b.m.children[c],b.m.Cb--,Ra(b)):!d&&!e&&(b.m.children[c]=a.m,b.m.Cb++,Ra(b))}}function K(a,b){this.Oa=a?a:Ua,this.$=b?b:Va}function Ua(a,b){return a<b?-1:a>b?1:0}function Wa(a,b){for(var c,d=a.$,e=m;!d.e();){c=a.Oa(b,d.key);if(0===c){if(d.left.e())return e?e.key:m;for(d=d.left;!d.right.e();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}g("Attempted to find predecessor key for a nonexistent key.  What gives?")}function Xa(a,b){this.Uc=b;for(this.Ib=[];!a.e();)this.Ib.push(a),a=a.left}function Ya(a){if(0===a.Ib.length)return m;var b=a.Ib.pop(),c;c=a.Uc?a.Uc(b.key,b.value):{key:b.key,value:b.value};for(b=b.right;!b.e();)a.Ib.push(b),b=b.left;return c}function Za(a,b,c,d,e){this.key=a,this.value=b,this.color=c!=m?c:k,this.left=d!=m?d:Va,this.right=e!=m?e:Va}function $a(a){return a.left.e()?a:$a(a.left)}function bb(a){return a.left.e()?Va:(!a.left.D()&&!a.left.left.D()&&(a=cb(a)),a=a.copy(m,m,m,bb(a.left),m),ab(a))}function ab(a){return a.right.D()&&!a.left.D()&&(a=fb(a)),a.left.D()&&a.left.left.D()&&(a=db(a)),a.left.D()&&a.right.D()&&(a=eb(a)),a}function cb(a){return a=eb(a),a.right.left.D()&&(a=a.copy(m,m,m,m,db(a.right)),a=fb(a),a=eb(a)),a}function fb(a){var b;return b=a.copy(m,m,k,m,a.right.left),a.right.copy(m,m,a.color,b,m)}function db(a){var b;return b=a.copy(m,m,k,a.left.right,m),a.left.copy(m,m,a.color,m,b)}function eb(a){var b,c;return b=a.left.copy(m,m,!a.left.color,m,m),c=a.right.copy(m,m,!a.right.color,m,m),a.copy(m,m,!a.color,b,c)}function gb(){}function kb(){}function lb(){this.w=[],this.gc=[],this.ed=[],this.Pb=[],this.Pb[0]=128;for(var a=1;64>a;++a)this.Pb[a]=0;this.reset()}function mb(a,b){var c;c||(c=0);for(var d=a.ed,e=c;e<c+64;e+=4)d[e/4]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3];for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}c=a.w[0];for(var g=a.w[1],h=a.w[2],i=a.w[3],j=a.w[4],k,e=0;80>e;e++)40>e?20>e?(f=i^g&(h^i),k=1518500249):(f=g^h^i,k=1859775393):60>e?(f=g&h|i&(g|h),k=2400959708):(f=g^h^i,k=3395469782),f=(c<<5|c>>>27)+f+j+k+d[e]&4294967295,j=i,i=h,h=(g<<30|g>>>2)&4294967295,g=c,c=f;a.w[0]=a.w[0]+c&4294967295,a.w[1]=a.w[1]+g&4294967295,a.w[2]=a.w[2]+h&4294967295,a.w[3]=a.w[3]+i&4294967295,a.w[4]=a.w[4]+j&4294967295}function nb(){this.Na={},this.length=0}function pb(a,b,c,d){this.host=a,this.xb=b,this.Wa=c,this.N=d||L.getItem(a)||this.host}function qb(a,b){b!==a.N&&(a.N=b,"s-"===a.N.substr(0,2)&&L.setItem(a.host,a.N))}function vb(){return ba.navigator?ba.navigator.userAgent:m}function Fb(a,b){ea(a)||g(Error("encodeByteArray takes an array as a parameter"));if(!Db){Db={},Eb={};for(var c=0;65>c;c++)Db[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c),Eb[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(c)}for(var c=b?Eb:Db,d=[],e=0;e<a.length;e+=3){var f=a[e],h=e+1<a.length,i=h?a[e+1]:0,j=e+2<a.length,k=j?a[e+2]:0,l=f>>2,f=(f&3)<<4|i>>4,i=(i&15)<<2|k>>6,k=k&63;j||(k=64,h||(i=64)),d.push(c[l],c[f],c[i],c[k])}return d.join("")}function z(a,b){a||g(Error("Firebase INTERNAL ASSERT FAILED:"+b))}function Ib(a){return a=ra(a),Fb(a,k)}function Kb(a){var b=ra(a),a=new lb;a.update(b);var b=[],c=8*a.wc;56>a.jb?a.update(a.Pb,56-a.jb):a.update(a.Pb,64-(a.jb-56));for(var d=63;56<=d;d--)a.gc[d]=c&255,c/=256;mb(a,a.gc);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c++]=a.w[d]>>e&255;return Fb(b)}function Lb(){for(var a="",b=0;b<arguments.length;b++)a=ea(arguments[b])?a+Lb.apply(m,arguments[b]):"object"==typeof arguments[b]?a+y(arguments[b]):a+arguments[b],a+=" ";return a}function M(){Nb===k&&(Nb=n,Mb===m&&"true"===L.getItem("logging_enabled")&&Ob(k));if(Mb){var a=Lb.apply(m,arguments);Mb(a)}}function Pb(a){return function(){M(a,arguments)}}function Qb(){if("undefined"!=typeof console){var a=Lb.apply(m,arguments);console.log("FIREBASE INTERNAL ERROR: "+a)}}function Rb(){if("undefined"!=typeof console){var a=Lb.apply(m,arguments);console.log("FIREBASE WARNING: "+a)}}function Sb(a){for(var b="",a=a.split("/"),c=0;c<a.length;c++)if(0<a[c].length){var d=a[c];try{d=decodeURIComponent(d.replace(/\+/g," "))}catch(e){}b+="/"+d}return b}function Ba(a){return fa(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function Tb(a,b){return a!==b?a===m?-1:b===m?1:typeof a!=typeof b?"number"==typeof a?-1:1:a>b?1:-1:0}function Ub(a,b){if(b&&a in b)return b[a];g(Error("Missing required key ("+a+") in object: "+JSON.stringify(b)))}function Ka(a){if("object"!=typeof a||a===m)return y(a);var b=[],c;for(c in a)b.push(c);b.sort(),c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=y(b[d]),c+=":",c+=Ka(a[b[d]]);return c+"}"}function Wb(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function Xb(a,b){this.qa=a,z(this.qa!==m,"LeafNode shouldn't be created with null value."),this.Ya="undefined"!=typeof b?b:m}function P(a,b){this.Q=a||new K,this.Ya="undefined"!=typeof b?b:m}function Yb(a,b,c){P.call(this,a,c),b===m&&(b=new K($b),a.ua(function(a,c){b=b.ia({name:a,ya:c.k()},c)})),this.ma=b}function Q(a,b){if("object"!=typeof a)return new Xb(a,b);if(a===m)return O;var c=m;".priority"in a?c=a[".priority"]:"undefined"!=typeof b&&(c=b),c!==m&&(c=Ha.test(c)?Number(c):c);if(".value"in a&&a[".value"]!==m)return new Xb(a[".value"],c);var c=new P(new K,c),d;for(d in a)if(a.hasOwnProperty(d)&&"."!==d.substring(0,1)){var e=Q(a[d]);if(e.J()||!e.e())c=c.C(d,e)}return c}function $b(a,b){return Tb(a.ya,b.ya)||(a.name!==b.name?a.name<b.name?-1:1:0)}function R(a,b){this.m=a,this.Wb=b}function ac(a){this.qc=a,this.Rb=[],this.Qa=0,this.hc=-1,this.Ga=m}function bc(a,b,c){for(a.Rb[b]=c;a.Rb[a.Qa];){b=a.Rb[a.Qa],delete a.Rb[a.Qa];for(c=0;c<b.length;++c)b[c]&&a.qc(b[c]);if(a.Qa===a.hc){a.Ga&&(clearTimeout(a.Ga),a.Ga(),a.Ga=m);break}a.Qa++}}function T(a,b,c){this.Db=a,this.c=Pb(this.Db),this.frames=this.lb=m,this.vc=0,this.Pa=(b.xb?"wss://":"ws://")+b.N+"/.ws?v=5",b.host!==b.N&&(this.Pa=this.Pa+"&ns="+b.Wa),c&&(this.Pa=this.Pa+"&s="+c)}function hc(a,b){a.frames.push(b);if(a.frames.length==a.vc){var c=a.frames.join("");a.frames=m,c=qa(c),ic(a),a.Nb(c)}}function ic(a){clearTimeout(a.lb),a.lb=setInterval(function(){a.S.send("0"),ic(a)},45e3)}function dc(){this.set={}}function lc(a,b,c){this.Db=a,this.c=Pb(a),this.Md=b,this.Ma=c,this.Ea=n,this.ab=function(a){b.host!==b.N&&(a.ns=b.Wa);var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(d+"="+a[d]);return(b.xb?"https://":"http://")+b.N+"/.lp?"+c.join("&")}}function nc(a,b,c,d){this.ab=d,this.xa=c,this.Y=new dc,this.Z=[],this.gb=Math.floor(1e8*Math.random()),this.Xc=k;if(S)this.gd=a,this.xd=b;else{this.cc=Gb(),window[jc+this.cc]=a,window[kc+this.cc]=b,a=document.createElement("iframe"),a.style.display="none",document.body?document.body.appendChild(a):g("Document body has not initialized. Wait to initialize Firebase until after the document is ready."),a.contentDocument?a.sa=a.contentDocument:a.contentWindow?a.sa=a.contentWindow.document:a.document&&(a.sa=a.document),this.ja=a;try{this.ja.sa.open(),this.ja.sa.write("<html><body></body></html>"),this.ja.sa.close()}catch(e){M("frame writing exception"),e.stack&&M(e.stack),M(e)}}}function oc(a,b,c){S?a.kd(b,c):setTimeout(function(){try{var d=a.ja.sa.createElement("script");d.type="text/javascript",d.async=k,d.src=b,d.onload=d.onreadystatechange=function(){var a=d.readyState;if(!a||"loaded"===a||"complete"===a)d.onload=d.onreadystatechange=m,d.parentNode&&d.parentNode.removeChild(d),c()},d.onerror=function(){M("Long-poll script failed to load."),a.close()},a.ja.sa.body.appendChild(d)}catch(e){}},1)}function rc(){function a(a,c){c&&c.isAvailable()&&b.push(c)}var b=[],c=sc;if("array"==da(c))for(var d=0;d<c.length;++d)a(0,c[d]);else G(c,a);this.bc=b}function U(a,b,c,d,e,f){this.id=a,this.c=Pb("c:"+this.id+":"),this.qc=c,this.ob=d,this.L=e,this.pc=f,this.B=b,this.Qb=[],this.Bc=0,this.xc=new rc,this.oa=0,this.c("Connection created"),tc(this)}function tc(a){var b,c=a.xc;0<c.bc.length?b=c.bc[0]:g(Error("No transports available")),a.H=new b("c:"+a.id+":"+a.Bc++,a.B),b=uc(a,a.H),c=vc(a,a.H),a.zb=a.H,a.wb=a.H,a.H.open(b,c),a.o=m}function vc(a,b){return function(c){b===a.H?(a.H=m,!c&&0===a.oa?(a.c("Realtime connection failed."),"s-"===a.B.N.substr(0,2)&&(L.removeItem(a.B.Wa),a.B.N=a.B.host)):1===a.oa&&a.c("Realtime connection lost."),a.close()):b===a.o?(c=a.o,a.o=m,(a.zb===c||a.wb===c)&&a.close()):a.c("closing an old connection")}}function uc(a,b){return function(c){if(2!=a.oa)if(b===a.wb){var d=Ub("t",c),c=Ub("d",c);if("c"==d){if(d=Ub("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.Ma=c.s,qb(a.B,f),0==a.oa&&(a.H.start(),c=a.H,a.c("Realtime connection established."),a.H=c,a.oa=1,a.ob&&(a.ob(d),a.ob=m),"4"!==e&&Rb("Protocol version mismatch detected"),c=1<a.xc.bc.length?a.xc.bc[1]:m)&&(a.o=new c("c:"+a.id+":"+a.Bc++,a.B,a.Ma),a.o.open(uc(a,a.o),vc(a,a.o)))}else if("n"===d){a.c("recvd end transmission on primary"),a.wb=a.o;for(c=0;c<a.Qb.length;++c)a.Lb(a.Qb[c]);a.Qb=[],wc(a)}else"s"===d?(a.c("Connection shutdown command received. Shutting down..."),a.pc&&(a.pc(c),a.pc=m),a.L=m,a.close()):"r"===d?(a.c("Reset packet received.  New host: "+c),qb(a.B,c),1===a.oa?a.close():(xc(a),tc(a))):Qb("Unknown control packet command: "+d)}else"d"==d&&a.Lb(c)}else b===a.o?(d=Ub("t",c),c=Ub("d",c),"c"==d?"t"in c&&(c=c.t,"a"===c?(a.o.start(),a.c("sending client ack on secondary"),a.o.send({t:"c",d:{t:"a",d:{}}}),a.c("Ending transmission on primary"),a.H.send({t:"c",d:{t:"n",d:{}}}),a.zb=a.o,wc(a)):"r"===c&&(a.c("Got a reset on secondary, closing it"),a.o.close(),(a.zb===a.o||a.wb===a.o)&&a.close())):"d"==d?a.Qb.push(c):g(Error("Unknown protocol layer: "+d))):a.c("message on old connection")}}function wc(a){a.zb===a.o&&a.wb===a.o&&(a.c("cleaning up and promoting a connection: "+a.o.Db),a.H=a.o,a.o=m)}function xc(a){a.c("Shutting down all connections"),a.H&&(a.H.close(),a.H=m),a.o&&(a.o.close(),a.o=m)}function yc(a,b,c,d){this.id=zc++,this.c=Pb("p:"+this.id+":"),this.yb=k,this.ca={},this.O=[],this.pb=0,this.oc={},this.ha=n,this.Vb=1e3,this.Mb=b,this.Pc=c,this.L=d,this.B=a,this.rc=m,this.Sb=[],this.za={},this.Gd=0,this.mb=this.Lc=m,setTimeout(w(this.Cc,this),0)}function Bc(a,b,c,d,e){a.c("Listen on "+b+" for "+c);var f={p:b},d=jb(d,function(a){return Ja(a)});"{}"!==c&&(f.q=d),a.La("l",f,function(d){a.c("listen response",d),d=d.s,"ok"!==d&&Cc(a,b,c),e&&e(d)},function(){a.c("timed out on listen...")})}function Dc(a){var b=a.Eb;a.ha&&b&&a.La("auth",{cred:b.hd},function(c){(c="ok"==c.s)||delete a.Eb,b.Ec||(b.Ec=k,b.ea&&b.ea(c))},function(){a.c("timed out on auth...")})}function Ec(a,b,c){b={p:b,d:c},a.c("onDisconnect",b),a.La("o",b,function(a){"ok"!==a.s&&g("onDisconnect failed: "+y(a.d))},function(){a.c("timed out on onDisconnect...")})}function Fc(a,b,c,d,e,f){c={p:c,d:d},s(f)&&(c.h=f),a.O.push({action:b,Tc:c,F:e}),a.pb++,b=a.O.length-1,a.ha&&Gc(a,b)}function Gc(a,b){var c=a.O[b].action,d=a.O[b].F;a.La(c,a.O[b].Tc,function(e){a.c(c+" response",e),delete a.O[b],a.pb--,0===a.pb&&(a.O=[]),d&&d(e.s)},function(){a.c("timed out on put...")})}function Cc(a,b,c){b=(new H(b)).toString(),c||(c="{}");var d=a.ca[b][c];return delete a.ca[b][c],d}function Hc(){this.Ka=O}function V(a,b){return a.Ka.I(b)}function W(a,b,c){a.Ka=a.Ka.$a(b,c)}function Ic(){this.Aa=new Hc,this.K=new Hc,this.Ca=new Hc,this.sb=new Qa}function Jc(a,b){for(var c=V(a.Aa,b),d=V(a.K,b),e=I(a.sb,b),f=n,g=e;g!==m;){if(g.i()!==m){f=k;break}g=g.parent()}return f?n:(c=Kc(c,d,e),c!==d?(W(a.K,b,c),k):n)}function Kc(a,b,c){return c.e()?a:c.i()!==m?b:(a=a||O,c.z(function(d){var d=d.name(),e=a.M(d),f=b.M(d),g=I(c,d),e=Kc(e,f,g);a=a.C(d,e)}),a)}function Lc(a,b){ib(b,function(b){var c=b.Hd,b=I(a.sb,b.path),d=b.i();z(d!==m,"pendingPut should not be null."),d===c&&J(b,m)})}function Mc(){this.rb=this.pa=m,this.set={}}function Nc(a){return a.contains("default")}function Oc(a){return a.pa!=m&&Nc(a)}function Pc(){this.Da=[]}function Qc(a,b){if(0!==b.length){a.Da.push.apply(a.Da,b);for(var c=0;c<a.Da.length;c++)if(a.Da[c]){var d=a.Da[c];a.Da[c]=m;var e=d.ea;e(d.Yc,d.tb)}a.Da=[]}}function X(a,b,c,d){this.type=a,this.la=b,this.U=c,this.tb=d}function Rc(a){this.G=a,this.fa=[],this.Dc=new Pc}function Sc(a,b,c,d,e){a.fa.push({type:b,ea:c,cancel:d,V:e});var d=[],f=Tc(a.f);a.kb&&f.push(new X("value",a.f));for(var g=0;g<f.length;g++)if(f[g].type===b){var h=new Y(a.G.n,a.G.path);f[g].U&&(h=h.A(f[g].U)),d.push({ea:e?w(c,e):c,Yc:new R(f[g].la,h),tb:f[g].tb})}Qc(a.Dc,d)}function Uc(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=e.type,g=new Y(a.G.n,a.G.path);b[d].U&&(g=g.A(b[d].U)),g=new R(b[d].la,g),"value"===e.type&&!g.Gb()?f+="("+g.ba()+")":"value"!==e.type&&(f+=" "+g.name()),M(a.G.n.u.id+": event:"+a.G.path+":"+a.G.Ha()+":"+f);for(f=0;f<a.fa.length;f++){var h=a.fa[f];b[d].type===h.type&&c.push({ea:h.V?w(h.ea,h.V):h.ea,Yc:g,tb:e.tb})}}Qc(a.Dc,c)}function Tc(a){var b=[];if(!a.J()){var c=m;a.z(function(a,d){b.push(new X("child_added",d,a,c)),c=a})}return b}function Vc(a){a.kb||(a.kb=k,Uc(a,[new X("value",a.f)]))}function Zc(a,b){Rc.call(this,a),this.f=b}function $c(a,b){this.Fb=a,this.Qc=b}function ad(a,b,c,d,e){var f=a.I(c),g=b.I(c),d=new $c(d,e),e=bd(d,c,f,g),g=f.k()!==g.k();if(e||g){f=c;for(c=e;f.parent()!==m;){var h=a.I(f),e=b.I(f),i=f.parent();if(!d.Fb||I(d.Fb,i).i()){var j=b.I(i),l=[],f=f.T<f.j.length?f.j[f.j.length-1]:m;if(h.e())h=j.W(f,e),l.push(new X("child_added",e,f,h));else if(e.e())l.push(new X("child_removed",h,f));else if(c&&(h=j.W(f,e),l.push(new X("child_changed",e,f,h))),g)h=j.W(f,e),l.push(new X("child_moved",e,f,h)),c=k;d.Qc(i,j,l)}f=i,g=n}}}function bd(a,b,c,d){var e,f=[];return c===d?e=n:c.J()&&d.J()?e=c.i()!==d.i():c.J()?(cd(a,b,O,d,f),e=k):d.J()?(cd(a,b,c,O,f),e=k):e=cd(a,b,c,d,f),(e=e||c.k()!==d.k())&&a.Qc(b,d,f),e}function cd(a,b,c,d,e){var f=n,g=!a.Fb||!I(a.Fb,b).e(),h=[],i=[],j=[],l={},o={},p,q,r,t;p=c.Sa(),r=Ya(p),q=d.Sa();for(t=Ya(q);r!==m||t!==m;){c=r===m?1:t===m?-1:r.key===t.key?0:$b({name:r.key,ya:r.value.k()},{name:t.key,ya:t.value.k()});if(0>c)f=l[r.key],s(f)?(j.push({Fc:r,$c:h[f]}),h[f]=m):(o[r.key]=i.length,i.push(r)),f=k,r=Ya(p);else{if(0<c)f=o[t.key],s(f)?(j.push({Fc:i[f],$c:t}),i[f]=m):(l[t.key]=h.length,h.push(t)),f=k;else{c=b.A(t.key);if(c=bd(a,c,r.value,t.value))r=d.W(t.key,t.value),e.push(new X("child_changed",t.value,t.key,r)),f=k;r=Ya(p)}t=Ya(q)}if(!g&&f)return k}for(g=0;g<i.length;g++)if(l=i[g])c=b.A(l.key),bd(a,c,l.value,O),e.push(new X("child_removed",l.value,l.key));for(g=0;g<h.length;g++)if(i=h[g])c=b.A(i.key),r=d.W(i.key,i.value),bd(a,c,O,i.value),e.push(new X("child_added",i.value,i.key,r));for(g=0;g<j.length;g++)i=j[g].Fc,h=j[g].$c,c=b.A(h.key),r=d.W(h.key,h.value),e.push(new X("child_moved",h.value,h.key,r)),(c=bd(a,c,i.value,h.value))&&e.push(new X("child_changed",h.value,h.key,r));return f}function dd(a,b){Rc.call(this,a),this.f=O,this.Ub(b,Tc(b))}function ed(a,b,c,d){if(a.J())return m;var e=m;return(d?a.ic:a.z).call(a,function(a,d){if(fd(b,a,d)&&(e=a,c--,0===c))return k}),e}function fd(a,b,c){for(var d=0;d<a.length;d++)if(!a[d](b,c.k()))return n;return k}function gd(a,b){this.u=a,this.g=b,this.Oc=b.Ka,this.ra=new Qa}function jd(a,b,c,d,e){for(var f=a.get(b),g=n,h=f.fa.length-1;0<=h;h--){var i=f.fa[h];if((!c||i.type===c)&&(!d||i.ea===d)&&(!e||i.V===e))if(f.fa.splice(h,1),g=k,c&&d)break}return(c=g&&!(0<f.fa.length))&&a.remove(b),c}function kd(a,b,c,d,e,f){var g=b.path(),g=I(a.ra,g),c=c?c.Ha():m,h=[];c&&"default"!==c?jd(b,c,d,e,f)&&h.push(c):ib(b.keys(),function(a){jd(b,a,d,e,f)&&h.push(a)}),b.e()&&J(g,m),c=hd(g);if(0<h.length&&!c){for(var i=g,j=g.parent(),c=n;!c&&j;){var l=j.i();if(l){z(!Oc(l));var o=i.name(),p=n;G(l.set,function(a){p=a.jc(o)||p}),p&&(c=k)}i=j,j=j.parent()}i=m;if(!Oc(b)){j=b.pa,b.pa=m;var q=[],r=function(b){var c=b.i();c&&Nc(c)?(q.push(c.path()),c.pa==m&&c.setActive(id(a,c))):(c&&c.pa==m&&c.setActive(id(a,c)),b.z(r))};r(g),i=q,j&&j()}return c?m:i}return m}function ld(a,b,c){Sa(I(a.ra,b),function(a){(a=a.i())&&G(a.set,function(a){Vc(a)})},c,k)}function md(a,b,c){function d(a){for(var b=0;b<c.length;++b)if(c[b].contains(a))return k;return n}var e=a.Oc,f=a.g.Ka;a.Oc=f;var g=b.toString();ad(e,f,b,a.ra,function(b,c,e){if(b.toString().substring(0,g.length)===g){var f=d(b);f&&ld(a,b,n),a.Tb(b,c,e),f&&ld(a,b,k)}else a.Tb(b,c,e)}),d(b)&&ld(a,b,k)}function hd(a){return Ta(a,function(a){return a.i()&&Oc(a.i())})}function id(a,b){if(a.u){var c=b.keys(),d=a.u,e=function(d){"ok"!==d?(Rb("on() or once() for "+b.path().toString()+" failed: "+d),b&&G(b.set,function(a){for(var b=0;b<a.fa.length;b++){var c=a.fa[b];c.cancel&&(c.V?w(c.cancel,c.V):c.cancel)()}}),kd(a,b)):ib(c,function(a){(a=b.get(a))&&Vc(a)})},f=b.toString(),g=b.path().toString();return d.ca[g]=d.ca[g]||{},z(!d.ca[g][f],"listen() called twice for same path/queryId."),d.ca[g][f]={Za:b.Za(),F:e},d.ha&&Bc(d,g,f,b.Za(),e),w(a.u.ad,a.u,b.path(),b.toString(),b.Za())}return ca}function nd(a,b,c,d,e,f){var g=b.path();if(f!==m){var h=[];return d.J()||d.z(function(a,b){h.push({path:g.A(a),Fa:b}),delete f[a]}),G(f,function(a,b){h.push({path:g.A(b),Fa:O})}),h}var b=a.ib(g,b,d,e),i=O,j=[];return G(b,function(b,f){var g=new H(f);b?i=i.C(f,d.I(g)):j=j.concat(od(a,d.I(g),I(c,g),e))}),[{path:g,Fa:i}].concat(j)}function pd(a,b,c,d,e){for(var f=I(a.ra,b),g=f.parent(),h=n;!h&&g!==m;){var i=g.i();i!==m&&(Nc(i)?h=k:(i=a.ib(b,i,c,d),f=f.name(),i[f]&&(h=k))),f=g,g=g.parent()}return h?[{path:b,Fa:c}]:(g=I(a.ra,b),h=g.i(),h!==m?Nc(h)?[{path:b,Fa:c}]:nd(a,h,g,c,d,e):od(a,c,g,d))}function od(a,b,c,d){var e=c.i();if(e!==m)return Nc(e)?[{path:c.path(),Fa:b}]:nd(a,e,c,b,d,m);if(b.J())return[];var f=[];return b.z(function(b,e){var g=new H(b);f=f.concat(od(a,e,I(c,g),d))}),f}function qd(a){this.B=a,this.u=new yc(this.B,w(this.Mb,this),w(this.td,this),w(this.vd,this)),this.ac=new Qa,this.g=new Ic,this.P=new gd(this.u,this.g.Ca),this.Jc=new Hc,this.kc=new gd(m,this.Jc),rd(this,n)}function rd(a,b){var c=new H("/.info/connected");W(a.Jc,c,Q(b)),md(a.kc,c,[c])}function vd(a,b){var c=new Y(a,b);return new R(V(a.g.Ca,b),c)}function ud(a,b){var c=I(a.ac,b);Ta(c,function(b){wd(a,b)}),wd(a,c),Sa(c,function(b){wd(a,b)})}function wd(a,b){var c=b.i();if(c!==m){for(var d=-1,e=[],f=0;f<c.length;f++)if(2===c[f].status)z(d===f-1,"All SENT items should be at beginning of queue."),d=f,c[f].status=4,c[f].zc="set";else if(c[f].dc(),c[f].F){var g=vd(a,b.path());e.push(w(c[f].F,m,n,g))}-1===d?J(b,m):c.length=d+1;for(f=0;f<e.length;f++)e[f]()}}function xd(a,b){var c=b||a.ac;b||yd(a,c);if(!c.e())if(c.i()!==m){var d=zd(a,c);if(0!==d.length){var e=c.path();if(2!==d[0].status&&4!==d[0].status){for(var f=0;f<d.length;f++)z(1===d[f].status,"tryToSendTransactionForNode_: items in queue should all be run."),d[f].status=2,d[f].Wc++;var g=V(a.g.K,e).hash();W(a.g.K,e,V(a.g.Ca,e));var h=V(a.g.K,e).ba(k),i=Gb();J(I(a.g.sb,e),i),a.u.put(e.toString(),h,function(b){a.c("transaction put response",{path:e.toString(),status:b});var g=I(a.g.sb,e),h=g.i();z(h!==m,"tryToSendTransactionsForNode_: pendingPut should not be null."),h===i&&(J(g,m),W(a.g.K,e,V(a.g.Aa,e)));if("ok"===b){b=[];for(f=0;f<d.length;f++)d[f].status=3,d[f].F&&(g=vd(a,d[f].path),b.push(w(d[f].F,m,k,g))),d[f].dc();yd(a,c),xd(a);for(f=0;f<b.length;f++)b[f]()}else{if("datastale"===b)for(f=0;f<d.length;f++)d[f].status=4===d[f].status?5:1;else{Rb("transaction at "+e+" failed: "+b);for(f=0;f<d.length;f++)d[f].status=5,d[f].zc=b}b=sd(a,e),td(a,b),md(a.P,b.path(),[e])}},g)}}}else c.z(function(b){xd(a,b)})}function td(a,b){var c=b.path();W(a.g.Ca,c,V(a.g.K,c));var d=zd(a,b);if(0!==d.length){for(var e=V(a.g.Ca,c),f=[],g=0;g<d.length;g++){var h=Oa(c,d[g].path),i=n,j;z(h!==m,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===d[g].status)i=k,j=d[g].zc;else if(1===d[g].status)if(25<=d[g].Wc)i=k,j="maxretry";else{var l=d[g].update(e.I(h).ba());s(l)?(za("transaction failed: Data returned ",l),e=e.$a(h,Q(l))):(i=k,j="nodata")}i&&(d[g].dc(),d[g].status=3,d[g].F&&(i=new Y(a,d[g].path),h=new R(e.I(h),i),f.push(w(d[g].F,m,n,h,j))))}d=V(a.g.K,c).k(),W(a.g.Ca,c,e.ec(d)),xd(a);for(g=0;g<f.length;g++)f[g]()}}function sd(a,b){for(var c,d=a.ac;(c=E(b))!==m&&d.i()===m;)d=I(d,c),b=La(b);return d}function zd(a,b){var c=[];return Ad(a,b,c),c.sort(function(a,b){return a.Sc-b.Sc}),c}function Ad(a,b,c){var d=b.i();if(d!==m)for(var e=0;e<d.length;e++)c.push(d[e]);b.z(function(b){Ad(a,b,c)})}function yd(a,b){var c=b.i();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d,J(b,0<c.length?c:m)}b.z(function(b){yd(a,b)})}function Z(){this.Ia={}}function Y(){var a,b,c;if(arguments[0]instanceof qd)c=arguments[0],a=arguments[1];else{A("new Firebase",1,2,arguments.length),a=arguments[0];var d="",e="",f=k;b="";if(u(a)){d=a.indexOf("//"),0<=d&&(f="http:"!==a.substring(0,d),a=a.substring(d+2));var h=a.indexOf("/");-1===h&&(h=a.length),d=a.substring(0,h),a=a.substring(h+1);var h=a.indexOf("/"),i=d.split(".");3==i.length?("firebase"===i[1]?(Rb(d+" is deprecated. Please use <YOUR FIREBASE>.firebaseio.com instead"),0<h?(e=a.substring(0,h),b=Sb(a.substring(h))):(e=a,b="/"),i[0]=e,i[1]="firebaseio",d=i.join(".")):(e=i[0],b=Sb("/"+a)),e=e.toLowerCase()):e=m}f||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Rb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),a=new pb(d,f,e),b=new H(b),f=b.toString(),(d=!u(a.host))||(d=0===a.host.length)||!(d=!xa(a.Wa))&&(d=0!==f.length)&&(f&&(f=f.replace(/^\/*\.info(\/|$)/,"/")),d=!u(f)||0===f.length||!!wa.test(f)),d&&g(Error(B("new Firebase",1,n)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')),arguments[1]?arguments[1]instanceof Z?c=arguments[1]:g(Error("Expected a valid Firebase.Context for second argument to new Firebase()")):c=Z.Hc(),f=(a.xb?"https://":"http://")+a.host,d=c.Ia[f],d||(d=new qd(a),c.Ia[f]=d),c=d,a=b}F.call(this,c,a)}function Ob(a,b){z(!b||a===k||a===n,"Can't turn on custom loggers persistently."),a===k?("undefined"!=typeof console&&("function"==typeof console.log?Mb=w(console.log,console):"object"==typeof console.log&&(Mb=function(a){console.log(a)})),b&&L.setItem("logging_enabled","true")):a?Mb=a:(Mb=m,L.removeItem("logging_enabled"))}var i=void 0,k=!0,m=null,n=!1,r,ba=this;Math.floor(2147483648*Math.random()).toString(36);var oa={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},pa=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,ua={},sa={},va=/[\[\].#$\/]/,wa=/[\[\].#$]/;F.prototype.nc=function(a,b){A("Query.on",2,4,arguments.length),Da("Query.on",a,n),D("Query.on",2,b,n);var c=Ia("Query.on",arguments[2],arguments[3]);return this.n.Bb(this,a,b,c.cancel,c.V),b},F.prototype.on=F.prototype.nc,F.prototype.Kb=function(a,b,c){A("Query.off",0,3,arguments.length),Da("Query.off",a,k),D("Query.off",2,b,k),ta("Query.off",3,c),this.n.Xb(this,a,b,c)},F.prototype.off=F.prototype.Kb,F.prototype.zd=function(a,b){function c(g){f&&(f=n,e.Kb(a,c),b.call(d.V,g))}A("Query.once",2,4,arguments.length),Da("Query.once",a,n),D("Query.once",2,b,n);var d=Ia("Query.once",arguments[2],arguments[3]),e=this,f=k;this.nc(a,c,function(){e.Kb(a,c),d.cancel&&d.cancel.call(d.V)})},F.prototype.once=F.prototype.zd,F.prototype.rd=function(a){return A("Query.limit",1,1,arguments.length),(!fa(a)||Math.floor(a)!==a||0>=a)&&g("Query.limit: First argument must be a positive integer."),new F(this.n,this.path,a,this.aa,this.na,this.ta,this.Ra)},F.prototype.limit=F.prototype.rd,F.prototype.Jd=function(a,b){return A("Query.startAt",0,2,arguments.length),Ca("Query.startAt",1,a,k),Ea("Query.startAt",b),s(a)||(b=a=m),new F(this.n,this.path,this.va,a,b,this.ta,this.Ra)},F.prototype.startAt=F.prototype.Jd,F.prototype.ld=function(a,b){return A("Query.endAt",0,2,arguments.length),Ca("Query.endAt",1,a,k),Ea("Query.endAt",b),new F(this.n,this.path,this.va,this.aa,this.na,a,b)},F.prototype.endAt=F.prototype.ld,F.prototype.Ha=function(){var a=Ka(Ja(this));return"{}"===a?"default":a},r=H.prototype,r.toString=function(){for(var a="",b=this.T;b<this.j.length;b++)""!==this.j[b]&&(a+="/"+this.j[b]);return a||"/"},r.parent=function(){if(this.T>=this.j.length)return m;for(var a=[],b=this.T;b<this.j.length-1;b++)a.push(this.j[b]);return new H(a,0)},r.A=function(a){for(var b=[],c=this.T;c<this.j.length;c++)b.push(this.j[c]);if(a instanceof H)for(c=a.T;c<a.j.length;c++)b.push(a.j[c]);else{a=a.split("/");for(c=0;c<a.length;c++)0<a[c].length&&b.push(a[c])}return new H(b,0)},r.e=function(){return this.T>=this.j.length},r.contains=function(a){var b=0;if(this.j.length>a.j.length)return n;for(;b<this.j.length;){if(this.j[b]!==a.j[b])return n;++b}return k},r=Qa.prototype,r.A=function(a){return a in this.m.children?this.m.children[a]:m},r.i=function(){return this.m.value},r.clear=function(){this.m.value=m,this.m.children={},this.m.Cb=0,Ra(this)},r.Gb=function(){return 0<this.m.Cb},r.e=function(){return this.i()===m&&!this.Gb()},r.z=function(a){for(var b in this.m.children)a(new Qa(b,this,this.m.children[b]))},r.path=function(){return new H(this.qb===m?this.Hb:this.qb.path()+"/"+this.Hb)},r.name=aa("Hb"),r.parent=aa("qb"),r=K.prototype,r.ia=function(a,b){return new K(this.Oa,this.$.ia(a,b,this.Oa).copy(m,m,n,m,m))},r.remove=function(a){return new K(this.Oa,this.$.remove(a,this.Oa).copy(m,m,n,m,m))},r.get=function(a){for(var b,c=this.$;!c.e();){b=this.Oa(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return m},r.e=function(){return this.$.e()},r.count=function(){return this.$.count()},r.nb=function(){return this.$.nb()},r.Ua=function(){return this.$.Ua()},r.ua=function(a){return this.$.ua(a)},r.Ja=function(a){return this.$.Ja(a)},r.Sa=function(a){return new Xa(this.$,a)},r=Za.prototype,r.copy=function(a,b,c,d,e){return new Za(a!=m?a:this.key,b!=m?b:this.value,c!=m?c:this.color,d!=m?d:this.left,e!=m?e:this.right)},r.count=function(){return this.left.count()+1+this.right.count()},r.e=p(n),r.ua=function(a){return this.left.ua(a)||a(this.key,this.value)||this.right.ua(a)},r.Ja=function(a){return this.right.Ja(a)||a(this.key,this.value)||this.left.Ja(a)},r.nb=function(){return $a(this).key},r.Ua=function(){return this.right.e()?this.key:this.right.Ua()},r.ia=function(a,b,c){var d,e;return e=this,d=c(a,e.key),e=0>d?e.copy(m,m,m,e.left.ia(a,b,c),m):0===d?e.copy(m,b,m,m,m):e.copy(m,m,m,m,e.right.ia(a,b,c)),ab(e)},r.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))!c.left.e()&&!c.left.D()&&!c.left.left.D()&&(c=cb(c)),c=c.copy(m,m,m,c.left.remove(a,b),m);else{c.left.D()&&(c=db(c)),!c.right.e()&&!c.right.D()&&!c.right.left.D()&&(c=eb(c),c.left.left.D()&&(c=db(c),c=eb(c)));if(0===b(a,c.key)){if(c.right.e())return Va;d=$a(c.right),c=c.copy(d.key,d.value,m,m,bb(c.right))}c=c.copy(m,m,m,m,c.right.remove(a,b))}return ab(c)},r.D=aa("color"),r=gb.prototype,r.copy=function(){return this},r.ia=function(a,b){return new Za(a,b,i,i,i)},r.remove=function(){return this},r.get=p(m),r.count=p(0),r.e=p(k),r.ua=p(n),r.Ja=p(n),r.nb=p(m),r.Ua=p(m),r.D=p(n);var Va=new gb,hb=Array.prototype,ib=hb.forEach?function(a,b,c){hb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=u(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},jb=hb.map?function(a,b,c){return hb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=u(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};ja(lb,kb),lb.prototype.reset=function(){this.w[0]=1732584193,this.w[1]=4023233417,this.w[2]=2562383102,this.w[3]=271733878,this.w[4]=3285377520,this.wc=this.jb=0},lb.prototype.update=function(a,b){s(b)||(b=a.length);var c=this.gc,d=this.jb,e=0;if(u(a))for(;e<b;)c[d++]=a.charCodeAt(e++),64==d&&(mb(this,c),d=0);else for(;e<b;)c[d++]=a[e++],64==d&&(mb(this,c),d=0);this.jb=d,this.wc+=b},nb.prototype.setItem=function(a,b){this.Na.hasOwnProperty(a)||(this.length+=1),this.Na[a]=b},nb.prototype.getItem=function(a){return this.Na.hasOwnProperty(a)?this.Na[a]:m},nb.prototype.removeItem=function(a){this.Na.hasOwnProperty(a)&&(this.length-=1,delete this.Na[a])};var L=m;if("undefined"!=typeof sessionStorage)try{sessionStorage.setItem("firebase-sentinel","cache"),sessionStorage.removeItem("firebase-sentinel"),L=sessionStorage}catch(ob){L=new nb}else L=new nb;var rb,sb,tb,ub;ub=tb=sb=rb=n;var wb;if(wb=vb()){var xb=ba.navigator;rb=0==wb.indexOf("Opera"),sb=!rb&&-1!=wb.indexOf("MSIE"),tb=!rb&&-1!=wb.indexOf("WebKit"),ub=!rb&&!tb&&"Gecko"==xb.product}var yb=sb,zb=ub,Ab=tb,Bb;if(rb&&ba.opera){var Cb=ba.opera.version;"function"==typeof Cb&&Cb()}else zb?Bb=/rv\:([^\);]+)(\)|;)/:yb?Bb=/MSIE\s+([^\);]+)(\)|;)/:Ab&&(Bb=/WebKit\/(\S+)/),Bb&&Bb.exec(vb());var Db=m,Eb=m,Gb,Hb=1;Gb=function(){return Hb++};var Mb=m,Nb=k,Ha=/^[\-+]?[0-9]*\.?[0-9]+(e\-|e\+|E\-|E\+|e|E)?[0-9]*$/,Vb=0;r=Xb.prototype,r.J=p(k),r.k=aa("Ya"),r.ec=function(a){return new Xb(this.qa,a)},r.M=function(){return O},r.I=function(a){return E(a)===m?this:O},r.W=p(m),r.C=function(a,b){return(new P(new K,this.Ya)).C(a,b)},r.$a=function(a,b){var c=E(a);return c===m?b:this.C(c,O.$a(La(a),b))},r.e=p(n),r.Jb=p(0),r.ba=function(a){return a&&this.k()!==m?{".value":this.i(),".priority":""+this.k()}:this.i()},r.hash=function(){var a="";this.k()!==m&&(a+="priority:"+this.k()+":");var b=typeof this.qa,a=a+(b+":");if("number"===b){b=this.qa,z(!Ba(b));var c,d,e,f;0===b?(e=d=0,c=-Infinity===1/b?1:0):(c=0>b,b=Math.abs(b),b>=Math.pow(2,-1022)?(e=Math.min(Math.floor(Math.log(b)/Math.LN2),1023),d=e+1023,e=Math.round(b*Math.pow(2,52-e)-Math.pow(2,52))):(d=0,e=Math.round(b/Math.pow(2,-1074)))),f=[];for(b=52;b;b-=1)f.push(e%2?1:0),e=Math.floor(e/2);for(b=11;b;b-=1)f.push(d%2?1:0),d=Math.floor(d/2);f.push(c?1:0),f.reverse(),c=f.join(""),d="";for(b=0;64>b;b+=8)e=parseInt(c.substr(b,8),2).toString(16),1===e.length&&(e="0"+e),d+=e;a+=d.toLowerCase()}else a+=this.qa;return Kb(a)},r.i=aa("qa"),r.toString=function(){return"string"==typeof this.qa?'"'+this.qa+'"':this.qa},r=P.prototype,r.J=p(n),r.k=aa("Ya"),r.ec=function(a){return new P(this.Q,a)},r.C=function(a,b){var c=this.Q.remove(a);return b&&b.e()&&(b=m),b!==m&&(c=c.ia(a,b)),b&&b.k()!==m?new Yb(c,m,this.Ya):new P(c,this.Ya)},r.$a=function(a,b){var c=E(a);if(c===m)return b;var d=this.M(c).$a(La(a),b);return this.C(c,d)},r.e=function(){return this.Q.e()},r.Jb=function(){return this.Q.count()};var Zb=/^\d+$/;r=P.prototype,r.ba=function(a){if(this.e())return m;var b={},c=0,d=0,e=k;this.z(function(f,g){b[f]=g.ba(a),c++,e&&Zb.test(f)?d=Math.max(d,Number(f)):e=n});if(!a&&e&&d<2*c){var f=[],g;for(g in b)f[g]=b[g];return f}return a&&this.k()!==m&&(b[".priority"]=""+this.k()),b},r.hash=function(){var a="";return this.k()!==m&&(a+="priority:"+this.k()+":"),this.z(function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)}),""===a?"":Kb(a)},r.M=function(a){return a=this.Q.get(a),a===m?O:a},r.I=function(a){var b=E(a);return b===m?this:this.M(b).I(La(a))},r.W=function(a){return Wa(this.Q,a)},r.Gc=function(){return this.Q.nb()},r.Ic=function(){return this.Q.Ua()},r.z=function(a){return this.Q.ua(a)},r.ic=function(a){return this.Q.Ja(a)},r.Sa=function(){return this.Q.Sa()},r.toString=function(){var a="{",b=k;return this.z(function(c,d){b?b=n:a+=", ",a+='"'+c+'" : '+d.toString()}),a+="}"};var O=new P(new K);ja(Yb,P),r=Yb.prototype,r.C=function(a,b){var c=this.M(a),d=this.Q,e=this.ma;return c!==m&&(d=d.remove(a),e=e.remove({name:a,ya:c.k()})),b&&b.e()&&(b=m),b!==m&&(d=d.ia(a,b),e=e.ia({name:a,ya:b.k()},b)),new Yb(d,e,this.k())},r.W=function(a,b){var c=Wa(this.ma,{name:a,ya:b.k()});return c?c.name:m},r.z=function(a){return this.ma.ua(function(b,c){return a(b.name,c)})},r.ic=function(a){return this.ma.Ja(function(b,c){return a(b.name,c)})},r.Sa=function(){return this.ma.Sa(function(a,b){return{key:a.name,value:b}})},r.Gc=function(){return this.ma.e()?m:this.ma.nb().name},r.Ic=function(){return this.ma.e()?m:this.ma.Ua().name},R.prototype.ba=function(){return A("Firebase.DataSnapshot.val",0,0,arguments.length),this.m.ba()},R.prototype.val=R.prototype.ba,R.prototype.od=function(){return A("Firebase.DataSnapshot.exportVal",0,0,arguments.length),this.m.ba(k)},R.prototype.exportVal=R.prototype.od,R.prototype.A=function(a){A("Firebase.DataSnapshot.child",0,1,arguments.length),fa(a)&&(a=String(a)),Fa("Firebase.DataSnapshot.child",a);var b=new H(a),c=this.Wb.A(b);return new R(this.m.I(b),c)},R.prototype.child=R.prototype.A,R.prototype.jc=function(a){A("Firebase.DataSnapshot.hasChild",1,1,arguments.length),Fa("Firebase.DataSnapshot.hasChild",a);var b=new H(a);return!this.m.I(b).e()},R.prototype.hasChild=R.prototype.jc,R.prototype.k=function(){A("Firebase.DataSnapshot.getPriority",0,0,arguments.length);var a=this.m.k();return a===m?a:""+a},R.prototype.getPriority=R.prototype.k,R.prototype.forEach=function(a){A("Firebase.DataSnapshot.forEach",1,1,arguments.length),D("Firebase.DataSnapshot.forEach",1,a,n);if(this.m.J())return n;var b=this;return this.m.z(function(c,d){return a(new R(d,b.Wb.A(c)))})},R.prototype.forEach=R.prototype.forEach,R.prototype.Gb=function(){return A("Firebase.DataSnapshot.hasChildren",0,0,arguments.length),this.m.J()?n:!this.m.e()},R.prototype.hasChildren=R.prototype.Gb,R.prototype.name=function(){return A("Firebase.DataSnapshot.name",0,0,arguments.length),this.Wb.name()},R.prototype.name=R.prototype.name,R.prototype.Jb=function(){return A("Firebase.DataSnapshot.numChildren",0,0,arguments.length),this.m.Jb()},R.prototype.numChildren=R.prototype.Jb,R.prototype.Cd=function(){return A("Firebase.DataSnapshot.ref",0,0,arguments.length),this.Wb},R.prototype.ref=R.prototype.Cd;var S;S=n;if(S){var cc=require("http"),ec=function(a,b,c){this.Db=a,this.c=Pb(a),this.B=b,this.Ma=c,this.X=this.Ea=n,this.Y=new dc,this.buffer={},this.Z=[],this.Bd=function(a){b.host!==b.N&&(a.ns=b.Wa);var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(d+"="+a[d]);return"/.hp?"+c.join("&")}};ec.isAvailable=p(n),r=ec.prototype,r.open=function(a,b){this.fb=0,this.L=b,this.Ad=new ac(a);var c=this;this.R=setTimeout(function(){c.c("Timed out trying to connect."),c.close(),c.R=m},3e4);var d=Math.floor(1e8*Math.random()),e={start:"t"};e.ser=d,e.v="5",this.Ma&&(e.s=this.Ma),this.c("Connecting via httppoll to "+this.B.N),this.lc(d,e)},r.start=function(){this.Kd()},r.send=function(a){for(var a=y(a),a=Ib(a),a=Wb(a,1048576),b=0;b<a.length;++b)this.md(this.fb,a.length,a[b]),this.fb++},r.close=function(){this.X||(this.c("Httppoll is being closed"),this.jd(),this.Ba())},r.md=function(a,b,c){this.Z.push({sc:a,yc:b,hb:c}),this.bb&&this.wa()},r.Kd=function(){this.bb=k;for(this.gb=Math.floor(1e8*Math.random());this.wa(););},r.wa=function(){if(this.bb&&this.Y.count()<(0<this.Z.length?2:1)){var a=this.gb++,b={};b.id=this.id,b.pw=this.Xa,b.ser=a;for(var c=[];0<this.Z.length;){if(!(1048608>=this.Z[0].hb.length))break;var d=this.Z.shift();c.push(d.sc+":"+d.yc+":"+d.hb)}var e=this,d=setTimeout(function(){e.Y.remove(a),e.wa()},25e3);return this.Y.add(a,d),this.lc(a,b,c.join("\n")),k}return n},r.ka=function(){this.X||(this.c("Httppoll is closing itself"),this.Ba(),this.L&&(this.L(this.Ea),this.L=m))},r.Ba=function(){this.X=k,this.bb=n,this.Ac(),G(this.Y.set,function(a){clearTimeout(a)}),this.Y.clear()},r.ud=function(a,b){var c=a.toString();this.buffer[b]=b in this.buffer?this.buffer[b]+c:c},r.wd=function(a){if(a in this.buffer){var b=this.buffer[a];delete this.buffer[a],b=qa(b),a=parseInt(Ub("x-firebase-response",a.headers)),bc(this.Ad,a,b)}},r.Ac=function(){this.R&&(clearTimeout(this.R),this.R=m)},r.fd=function(a){(a=this.Y.get(a))&&clearTimeout(a)},r.yd=function(a,b){this.Ac(),this.fd(a),this.Y.remove(a),this.wa();if(200!=b.statusCode)this.c("error code received: "+b.statusCode),this.ka();else{"x-firebase-poll-id"in b.headers&&"x-firebase-poll-pw"in b.headers&&(this.id=b.headers["x-firebase-poll-id"],this.Xa=b.headers["x-firebase-poll-pw"]),"x-firebase-poll-close"in b.headers&&(this.c("recvd close"),this.bb=n);var c=this;b.on("data",function(a){c.ud(a,b)}),b.on("end",function(){c.wd(b)})}},r.lc=function(a,b,c){var c=c||"",b=this.Bd(b),d=this.B.N,e=d.split(":"),f=this.B.xb?443:80;1<e.length&&(d=e[0],f=parseInt(e[1]));var g=this,b=cc.request({method:"POST",host:d,port:f,path:b},function(b){g.yd(a,b)});b.on("error",function(a){g.c("An error occurred: "+a.message),g.ka()}),b.end(c)},r.jd=function(){if(this.bb&&this.id&&this.Xa){this.c("doing a disconnect");var a={};a.id=this.id,a.pw=this.Xa,a.disconn="t",this.lc(0,a)}}}else ec={isAvailable:p(n)};var fc=m;S?fc=require("faye-websocket").Client:"undefined"!=typeof MozWebSocket?fc=MozWebSocket:"undefined"!=typeof WebSocket&&(fc=WebSocket);var gc;T.prototype.open=function(a,b){this.xa=b,this.Nb=a,this.c("websocket connecting to "+this.Pa),this.S=new fc(this.Pa),this.Ea=n;var c=this;this.S.onopen=function(){c.c("Websocket connected."),c.Ea=k},this.S.onclose=function(){c.c("Websocket connection was disconnected."),c.S=m,c.ka()},this.S.onmessage=function(a){if(c.S!==m)if(a=a.data,c.frames!==m)hc(c,a);else{a:{z(c.frames===m,"We already have a frame buffer");if(4>=a.length){var b=Number(a);if(!isNaN(b)){c.vc=b,c.frames=[],a=m;break a}}c.vc=1,c.frames=[]}a!==m&&hc(c,a)}},this.S.onerror=function(){c.c("WebSocket error.  Closing connection."),c.ka()}},T.prototype.start=function(){},T.isAvailable=function(){return("undefined"==typeof navigator||"Opera"!==navigator.appName)&&fc!==m&&!gc},T.prototype.send=function(a){ic(this),a=y(a),a=Wb(a,16384),1<a.length&&this.S.send(String(a.length));for(var b=0;b<a.length;b++)this.S.send(a[b])},T.prototype.Ba=function(){this.X=k,this.lb&&(clearTimeout(this.lb),this.lb=m),this.S&&(this.S.close(),this.S=m)},T.prototype.ka=function(){this.X||(this.c("WebSocket is closing itself"),this.Ba(),this.xa&&(this.xa(this.Ea),this.xa=m))},T.prototype.close=function(){this.X||(this.c("WebSocket is being closed"),this.Ba())},r=dc.prototype,r.add=function(a,b){this.set[a]=b!==m?b:k},r.contains=function(a){return this.set.hasOwnProperty(a)},r.get=function(a){return this.set[a]},r.remove=function(a){delete this.set[a]},r.clear=function(){this.set={}},r.e=function(){var a;a:{for(a in this.set){a=n;break a}a=k}return a},r.count=function(){var a=0,b;for(b in this.set)a++;return a},r.keys=function(){var a=[],b;for(b in this.set)this.set.hasOwnProperty(b)&&a.push(b);return a};var jc="pLPCommand",kc="pRTLPCB",mc;lc.prototype.open=function(a,b){function c(){if(!d.X){d.da=new nc(function(a,b,c){d.da&&((d.R&&(clearTimeout(d.R),d.R=m),d.Ea=k,"start"==a)?(d.id=b,d.Xa=c):"close"===a?b?(d.da.Xc=n,a=d.Nc,a.hc=b,a.Ga=function(){d.ka()},a.hc<a.Qa&&(a.Ga(),a.Ga=m)):d.ka():g(Error("Unrecognized command received: "+a)))},function(a,b){bc(d.Nc,a,b)},function(){d.ka()},d.ab);var a={start:"t"};a.ser=Math.floor(1e8*Math.random()),d.da.cc&&(a.cb=d.da.cc),a.v="5",d.Ma&&(a.s=d.Ma),a=d.ab(a),d.c("Connecting via long-poll to "+a),oc(d.da,a,function(){})}}this.fb=0,this.L=b,this.Nc=new ac(a),this.X=n;var d=this;this.R=setTimeout(function(){d.c("Timed out trying to connect."),d.close(),d.R=m},3e4);if(S||"complete"===document.readyState)c();else{var e=n,f=function(){document.body?e||(e=k,c()):setTimeout(f,10)};document.addEventListener?(document.addEventListener("DOMContentLoaded",f,n),window.addEventListener("load",f,n)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&f()},n),window.attachEvent("onload",f,n))}},lc.prototype.start=function(){var a=this.da,b=this.Xa;a.mc=this.id,a.Mc=b;for(a.fc=k;a.wa(););a=this.id,b=this.Xa;if(!S){this.Va=document.createElement("iframe");var c={dframe:"t"};c.id=a,c.pw=b,a=this.ab(c),this.Va.src=a,this.Va.style.display="none",document.body.appendChild(this.Va)}},lc.isAvailable=function(){return mc||!S},lc.prototype.Ba=function(){this.X=k,this.da&&(this.da.close(),this.da=m),this.Va&&(document.body.removeChild(this.Va),this.Va=m),this.R&&(clearTimeout(this.R),this.R=m)},lc.prototype.ka=function(){this.X||(this.c("Longpoll is closing itself"),this.Ba(),this.L&&(this.L(this.Ea),this.L=m))},lc.prototype.close=function(){this.X||(this.c("Longpoll is being closed."),this.Ba())},lc.prototype.send=function(a){for(var a=y(a),a=Ib(a),a=Wb(a,1840),b=0;b<a.length;b++){var c=this.da;c.Z.push({sc:this.fb,yc:a.length,hb:a[b]}),c.fc&&c.wa(),this.fb++}},nc.prototype.close=function(){this.fc=n,this.ja&&(this.ja.sa.body.innerHTML="",document.body.removeChild(this.ja),this.ja=m);if(S&&this.mc){var a={disconn:"t"};a.id=this.mc,a.pw=this.Mc,a=this.ab(a),pc(a)}if(a=this.xa)this.xa=m,a()},nc.prototype.wa=function(){if(this.fc&&this.Xc&&this.Y.count()<(0<this.Z.length?2:1)){this.gb++;var a={};a.id=this.mc,a.pw=this.Mc,a.ser=this.gb;for(var a=this.ab(a),b="",c=0;0<this.Z.length;){if(!(1870>=this.Z[0].hb.length+30+b.length))break;var d=this.Z.shift(),b=b+"&seg"+c+"="+d.sc+"&ts"+c+"="+d.yc+"&d"+c+"="+d.hb;c++}var a=a+b,e=this.gb,f=this;f.Y.add(e);var g=function(){f.Y.remove(e),f.wa()},h=setTimeout(g,25e3);return oc(this,a,function(){clearTimeout(h),g()}),k}return n};if("undefined"!=typeof S&&S){var pc=function(a,b){qc||(qc=require("request")),qc(a,function(a,c,d){a&&g("Rest request for "+url+" failed."),b&&b(d)})},qc;nc.prototype.kd=function(a,b){var c=this;pc({url:a,Ld:k},function(a){c.nd(a),b()})},nc.prototype.nd=function(a){eval("var document = function("+jc+", "+kc+") {"+a+"}"),document(this.gd,this.xd)}}var sc=[lc,ec,T];U.prototype.tc=function(a){a={t:"d",d:a},1!==this.oa&&g("Connection is not connected"),this.zb.send(a)},U.prototype.Lb=function(a){this.qc(a)},U.prototype.close=function(){2!==this.oa&&(this.c("Closing realtime connection."),this.oa=2,xc(this),this.L&&(this.L(),this.L=m))};var zc=0,Ac=0;r=yc.prototype,r.La=function(a,b,c,d){var e=++this.Gd,a={r:e,a:a,b:b};this.c(JSON.stringify(a)),this.ha?this.ub.tc(a):this.Sb.push(a);var f=this,a=setTimeout(function(){var a=f.za[e];a&&(delete f.za[e],a.ga&&a.ga.Ob&&a.ga.Ob())},45e3);this.za[e]={ga:{Nb:c,Ob:d},Zc:a}},r.eb=function(a,b){this.Eb={hd:a,Ec:n,ea:b},this.c("Authenticating using credential: "+this.Eb),Dc(this)},r.Ab=function(){delete this.Eb,this.ha&&this.La("unauth",{},function(){},function(){})},r.ad=function(a,b,c){a=a.toString();if(Cc(this,a,b)&&this.ha){this.c("Unlisten on "+a+" for "+b);var d=this,a={p:a},c=jb(c,function(a){return Ja(a)});"{}"!==b&&(a.q=c),this.La("u",a,m,function(){d.c("timed out on unlisten...")})}},r.xa=function(a,b){this.oc[a]=b,this.ha&&Ec(this,a,b)},r.put=function(a,b,c,d){Fc(this,"p",a,b,c,d)},r.Lb=function(a){if("r"in a){this.c("from server: "+JSON.stringify(a));var b=a.r,c=this.za[b];c&&(delete this.za[b],clearTimeout(c.Zc),c.ga&&c.ga.Nb&&c.ga.Nb(a.b))}else"error"in a&&g("A server-side error has occurred: "+a.error),"a"in a&&(b=a.a,c=a.b,this.c("handleServerMessage",b,c),"d"===b?this.Mb(c.p,c.d):"m"===b?this.Mb(c.p,c.d,k):"c"===b?(a=c.p,b=(b=c.q)?jb(b,function(a){return Ka(a)}).join("$"):"{}",(a=Cc(this,a,b))&&a.F&&a.F("permission_denied")):"sd"===b?this.rc?this.rc(c):"msg"in c&&"undefined"!=typeof console&&console.log("FIREBASE: "+c.msg.replace("\n","\nFIREBASE: ")):Qb("Unrecognized action received from server: "+y(b)+"\nAre you using the latest client?"))},r.ob=function(a){this.c("connection ready"),this.ha=k,this.mb=(new Date).getTime(),Vb=a-(new Date).getTime();for(a=0;a<this.Sb.length;a++)this.ub.tc(this.Sb[a]);this.Sb=[],Dc(this);for(var b in this.ca)for(var c in this.ca[b])a=this.ca[b][c],Bc(this,b,c,a.Za,a.F);for(b in this.oc)Ec(this,b,this.oc[b]);for(b=0;b<this.O.length;b++)this.O[b]&&Gc(this,b);this.Pc&&this.Pc()},r.Rc=function(){this.ha=n,this.c("data client disconnected");if(!this.yb){for(var a=0;a<this.O.length;a++){var b=this.O[a];b&&"h"in b.Tc&&(b.F&&b.F("disconnect"),delete this.O[a],this.pb--)}0===this.pb&&(this.O=[]);for(var c in this.za)a=this.za[c],delete this.za[c],a!==m&&(a.ga&&a.ga.Ob&&a.ga.Ob(),clearTimeout(a.Zc))}var d=w(function(){this.Cc()},this);this.yb?(this.mb&&(3e4<(new Date).getTime()-this.mb&&(this.Vb=1e3),this.mb=m),c=Math.max(0,this.Vb-((new Date).getTime()-this.Lc)),c*=Math.random(),this.c("Trying to reconnect in "+c+"ms"),setTimeout(d,c),this.Vb=Math.min(3e4,1.3*this.Vb)):this.Vc=function(){setTimeout(d,0)},this.L&&this.L()},r.Cc=function(){if(this.yb){this.c("Making a connection attempt"),this.Lc=(new Date).getTime(),this.mb=m;var a=w(this.Lb,this),b=w(this.ob,this),c=w(this.Rc,this),d=this.id+":"+Ac++;this.ub=new U(d,this.B,a,b,c,function(a){g(Error(a))})}},r.Ta=function(){this.yb=n,this.ub?this.ub.close():this.Rc()},r.vb=function(){this.yb=k,this.Vc(),this.Vc=i},Hc.prototype.toString=function(){return this.Ka.toString()},Ic.prototype.set=function(a,b){var c=this,d=[];return ib(b,function(a){var b=a.path,a=a.Fa,e=Gb();J(I(c.sb,b),e),W(c.K,b,a),d.push({path:b,Hd:e})}),d},ja(Mc,dc),r=Mc.prototype,r.setActive=function(a){this.pa=a},r.defaultView=function(){return Nc(this)?this.get("default"):m},r.path=aa("rb"),r.toString=function(){return jb(this.keys(),function(a){return"default"===a?"{}":a}).join("$")},r.Za=function(){var a=[];return G(this.set,function(b){a.push(b.G)}),a},Rc.prototype.Tb=function(a,b){b=this.Ub(a,b),Uc(this,b)},ja(Zc,Rc),Zc.prototype.Ub=function(a,b){return this.f=a,this.kb&&b.push(new X("value",this.f)),b},Zc.prototype.ib=function(){return{}},ja(dd,Rc),dd.prototype.Ub=function(a,b){var c=[],d=this.G;s(d.aa)&&(s(d.na)&&d.na!=m?c.push(function(a,b){var c=Tb(b,d.aa);return 0<c||0===c&&a>=d.na}):c.push(function(a,b){return 0<=Tb(b,d.aa)})),s(d.ta)&&(s(d.Ra)?c.push(function(a,b){var c=Tb(b,d.ta);return 0>c||0===c&&a<=d.Ra}):c.push(function(a,b){return 0>=Tb(b,d.ta)}));var e=m,f=m;if(s(this.G.va))if(s(this.G.aa)){if(e=ed(a,c,this.G.va,n)){var g=a.M(e).k();c.push(function(a,b){var c=Tb(b,g);return 0>c||0===c&&a<=e})}}else if(f=ed(a,c,this.G.va,k)){var h=a.M(f).k();c.push(function(a,b){var c=Tb(b,h);return 0<c||0===c&&a>=f})}for(var i=[],j=[],l=[],o=[],p=0;p<b.length;p++){var q=b[p].U,r=b[p].la;switch(b[p].type){case"child_added":fd(c,q,r)&&(this.f=this.f.C(q,r),j.push(b[p]));break;case"child_removed":this.f.M(q).e()||(this.f=this.f.C(q,m),i.push(b[p]));break;case"child_changed":!this.f.M(q).e()&&fd(c,q,r)&&(this.f=this.f.C(q,r),o.push(b[p]));break;case"child_moved":var t=!this.f.M(q).e(),u=fd(c,q,r);t?u?(this.f=this.f.C(q,r),l.push(b[p])):(i.push(new X("child_removed",this.f.M(q),q)),this.f=this.f.C(q,m)):u&&(this.f=this.f.C(q,r),j.push(b[p]))}}var v=e||f;if(v){var w=(p=f!==m)?this.f.Gc():this.f.Ic(),x=n,y=n,z=this;(p?a.ic:a.z).call(a,function(a,b){!y&&w===m&&(y=k);if(y&&x)return k;x?(i.push(new X("child_removed",z.f.M(a),a)),z.f=z.f.C(a,m)):y&&(j.push(new X("child_added",b,a)),z.f=z.f.C(a,b)),w===a&&(y=k),a===v&&(x=k)})}for(p=0;p<j.length;p++)c=j[p],q=this.f.W(c.U,c.la),i.push(new X("child_added",c.la,c.U,q));for(p=0;p<l.length;p++)c=l[p],q=this.f.W(c.U,c.la),i.push(new X("child_moved",c.la,c.U,q));for(p=0;p<o.length;p++)c=o[p],q=this.f.W(c.U,c.la),i.push(new X("child_changed",c.la,c.U,q));return this.kb&&0<i.length&&i.push(new X("value",this.f)),i},dd.prototype.jc=function(a){return this.f.M(a)!==O},dd.prototype.ib=function(a,b,c){var d={};this.f.J()||this.f.z(function(a){d[a]=k});var e=this.f,c=V(c,new H("")),f=new Qa;J(I(f,this.G.path),k);var g=O.$a(a,b),h=[];return ad(c,g,a,f,function(a,b,c){h=h.concat(c)}),this.Ub(b,h),this.f.J()||this.f.z(function(a){d[a]=k}),this.f=e,d},gd.prototype.Bb=function(a,b,c,d,e){var f=a.path,g=I(this.ra,f),h=g.i();h===m?(h=new Mc,J(g,h)):z(!h.e(),"We shouldn't be storing empty QueryMaps");var i=a.Ha();if(h.contains(i))Sc(h.get(i),b,c,d,e);else{var j=this.g.Ka.I(f),a="default"===a.Ha()?new Zc(a,j):new dd(a,j);if(Oc(h)||hd(g))h.add(i,a),h.rb||(h.rb=a.G.path);else{var l,n;h.e()||(l=h.toString(),n=h.Za()),h.add(i,a),h.rb||(h.rb=a.G.path),h.setActive(id(this,h)),l&&n&&this.u.ad(h.path(),l,n)}Oc(h)&&Sa(g,function(a){if(a=a.i())a.pa&&a.pa(),a.pa=m}),Sc(a,b,c,d,e),(b=(b=Ta(I(this.ra,f),function(a){var b;if(b=a.i())if(b=a.i().defaultView())b=a.i().defaultView().kb;if(b)return k},k))||this.u===m)&&Vc(a)}},gd.prototype.Xb=function(a,b,c,d){var e=I(this.ra,a.path).i();return e===m?m:kd(this,e,a,b,c,d)},gd.prototype.Tb=function(a,b,c){a=I(this.ra,a).i(),a!==m&&G(a.set,function(a){a.Tb(b,c)})},gd.prototype.ib=function(a,b,c,d){var e={};return G(b.set,function(b){b=b.ib(a,c,d),G(b,function(a,b){e[b]=b in e?e:a})}),c.J()||c.z(function(a){a in e||(e[a]=n)}),e},r=qd.prototype,r.toString=function(){return(this.B.xb?"https://":"http://")+this.B.host},r.name=function(){return this.B.Wa},r.Mb=function(a,b,c){var d=[],e=m;if(9<=a.length&&a.lastIndexOf(".priority")===a.length-9)a=new H(a.substring(0,a.length-9)),b!==m&&Ha.test(b)&&(b=Number(b)),c=V(this.g.Aa,a).ec(b),d.push(a);else if(c){var e=b,a=new H(a),c=V(this.g.Aa,a),f;for(f in b){var g=Q(b[f]),c=c.C(f,g);d.push(a.A(f))}}else a=new H(a),c=Q(b),d.push(a);e=pd(this.P,a,c,this.g.K,e),b=n;for(f=0;f<e.length;++f){var c=e[f],g=this.g,h=c.path;W(g.Aa,h,c.Fa),b=Jc(g,h)||b}b&&(a=sd(this,a),td(this,a),a=a.path()),md(this.P,a,d)},r.td=function(){rd(this,k)},r.vd=function(){rd(this,n)},r.eb=function(a,b){this.u.eb(a,b)},r.Ab=function(){this.u.Ab()},r.$b=function(a,b,c,d){c!==m&&Ha.test(c)&&(c=Number(c)),this.c("set",{path:a.toString(),value:b});var b=Q(b,c),c=pd(this.P,a,b,this.g.K,m),e=this.g.set(a,c),f=this;this.u.put(a.toString(),b.ba(k),function(b){var c="ok"===b;Lc(f.g,e),c||(Rb("set at "+a+" failed: "+b),Jc(f.g,a),b=sd(f,a),td(f,b),md(f.P,b.path(),[])),d&&d(c)}),b=sd(this,a),ud(this,a),td(this,b),md(this.P,b.path(),[a])},r.update=function(a,b,c){this.c("update",{path:a.toString(),value:b});var d=V(this.g.Ca,a),e=k,f=[],g;for(g in b){var e=n,h=Q(b[g]),d=d.C(g,h);f.push(a.A(g))}if(e)M("update() called with empty data.  Don't do anything."),c&&c(k);else{var d=pd(this.P,a,d,this.g.K,b),j=this.g.set(a,d),l=this;Fc(this.u,"m",a.toString(),b,function(b){z("ok"===b||"permission_denied"===b,"merge at "+a+" failed."),b="ok"===b,Lc(l.g,j),c&&c(b)},i),b=sd(this,a),ud(this,a),td(this,b),md(this.P,b.path(),f)}},r.uc=function(a,b,c){this.c("setPriority",{path:a.toString(),ya:b});var d=V(this.g.K,a).ec(b),d=pd(this.P,a,d,this.g.K,m),e=this.g.set(a,d),f=this;this.u.put(a.toString()+"/.priority",b,function(a){a="ok"===a,Lc(f.g,e),c&&c(a)}),a=sd(this,a),td(this,a),md(this.P,a.path(),[])},r.Zb=function(a,b){this.u.xa(a.toString(),b)},r.Bb=function(a,b,c,d,e){".info"===E(a.path)?this.kc.Bb(a,b,c,d,e):this.P.Bb(a,b,c,d,e)},r.Xb=function(a,b,c,d){if(".info"===E(a.path))this.kc.Xb(a,b,c,d);else if(b=this.P.Xb(a,b,c,d),b!==m){for(var c=this.g,a=a.path,d=[],e=0;e<b.length;++e)d[e]=V(c.Aa,b[e]);W(c.Aa,a,O);for(e=0;e<b.length;++e)W(c.Aa,b[e],d[e])}},r.Ta=function(){this.u.Ta()},r.vb=function(){this.u.vb()},r.c=function(){M("r:"+this.u.id+":",arguments)},Z.Hc=function(){return Z.Kc?Z.Kc:Z.Kc=new Z},Z.prototype.Ta=function(){for(var a in this.Ia)this.Ia[a].Ta()},Z.prototype.interrupt=Z.prototype.Ta,Z.prototype.vb=function(){for(var a in this.Ia)this.Ia[a].vb()},Z.prototype.resume=Z.prototype.vb;var $={Fd:function(){return Z.Hc().Ia}};$.repos=$.Fd,$.qd=function(a){var b=P.prototype.hash;return P.prototype.hash=a,function(){P.prototype.hash=b}},$.hijackHash=$.qd,$.Ha=function(a){return a.Ha()},$.queryIdentifier=$.Ha,$.sd=function(a){return a.n.u.ca},$.listens=$.sd,$.Dd=function(a){return a.n.u.ub},$.refConnection=$.Dd,$.cd=yc,$.DataConnection=$.cd,yc.prototype.sendRequest=yc.prototype.La,yc.prototype.interrupt=yc.prototype.Ta,$.dd=U,$.RealTimeConnection=$.dd,U.prototype.sendRequest=U.prototype.tc,U.prototype.close=U.prototype.close,$.bd=pb,$.ConnectionTarget=$.bd,$.pd=function(){mc=gc=k},$.forceLongPolling=$.pd,$.Id=function(a,b){a.n.u.rc=b},$.setSecurityDebugCallback=$.Id;var Bd,Cd=0,Dd=[];Bd=function(){var a=(new Date).getTime()+Vb,b=a===Cd;Cd=a;for(var c=Array(8),d=7;0<=d;d--)c[d]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(a%64),a=Math.floor(a/64);z(0===a),a=c.join("");if(b){for(d=11;0<=d&&63===Dd[d];d--)Dd[d]=0;Dd[d]++}else for(d=0;12>d;d++)Dd[d]=Math.floor(64*Math.random());for(d=0;12>d;d++)a+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(Dd[d]);return z(20===a.length,"NextPushId: Length should be 20."),a},ja(Y,F);var Ed=Y,Fd=["Firebase"],Gd=ba;!(Fd[0]in Gd)&&Gd.execScript&&Gd.execScript("var "+Fd[0]);for(var Hd;Fd.length&&(Hd=Fd.shift());)!Fd.length&&s(Ed)?Gd[Hd]=Ed:Gd=Gd[Hd]?Gd[Hd]:Gd[Hd]={};S&&(module.exports=Y),Y.prototype.name=function(){return A("Firebase.name",0,0,arguments.length),this.path.e()?m:this.path.T<this.path.j.length?this.path.j[this.path.j.length-1]:m},Y.prototype.name=Y.prototype.name,Y.prototype.A=function(a){A("Firebase.child",1,1,arguments.length);if(fa(a))a=String(a);else if(!(a instanceof H))if(E(this.path)===m){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/")),Fa("Firebase.child",b)}else Fa("Firebase.child",a);return new Y(this.n,this.path.A(a))},Y.prototype.child=Y.prototype.A,Y.prototype.parent=function(){A("Firebase.parent",0,0,arguments.length);var a=this.path.parent();return a===m?m:new Y(this.n,a)},Y.prototype.parent=Y.prototype.parent,Y.prototype.toString=function(){A("Firebase.toString",0,0,arguments.length);var a;if(this.parent()===m)a=this.n.toString();else{a=this.parent().toString()+"/";var b=this.name();a+=encodeURIComponent(String(b))}return a},Y.prototype.toString=Y.prototype.toString,Y.prototype.set=function(a,b){return A("Firebase.set",1,2,arguments.length),Ga("Firebase.set",this.path),ya("Firebase.set",a,n),D("Firebase.set",2,b,k),this.n.$b(this.path,a,m,b)},Y.prototype.set=Y.prototype.set,Y.prototype.update=function(a,b){return A("Firebase.update",1,2,arguments.length),Ga("Firebase.update",this.path),ga(a)||g(Error(B("Firebase.update",1,n)+" must be an object containing the children to replace.")),ya("Firebase.update",a,n),D("Firebase.update",2,b,k),this.n.update(this.path,a,b)},Y.prototype.update=Y.prototype.update,Y.prototype.$b=function(a,b,c){return A("Firebase.setWithPriority",2,3,arguments.length),Ga("Firebase.setWithPriority",this.path),ya("Firebase.setWithPriority",a,n),Ca("Firebase.setWithPriority",2,b,n),D("Firebase.setWithPriority",3,c,k),(".length"===this.name()||".keys"===this.name())&&g("Firebase.setWithPriority failed: "+this.name()+" is a read-only object."),this.n.$b(this.path,a,b,c)},Y.prototype.setWithPriority=Y.prototype.$b,Y.prototype.remove=function(a){A("Firebase.remove",0,1,arguments.length),Ga("Firebase.remove",this.path),D("Firebase.remove",1,a,k),this.set(m,a)},Y.prototype.remove=Y.prototype.remove,Y.prototype.transaction=function(a,b){function c(){}A("Firebase.transaction",1,2,arguments.length),Ga("Firebase.transaction",this.path),D("Firebase.transaction",1,a,n),D("Firebase.transaction",2,b,k),(".length"===this.name()||".keys"===this.name())&&g("Firebase.transaction failed: "+this.name()+" is a read-only object.");var d=this.n,e=this.path;d.c("transaction on "+e);var f=new Y(d,e);f.nc("value",c);var h={path:e,update:a,F:b,Sc:Gb(),Wc:0,dc:function(){f.Kb("value",c)}},i=d.g.Ca,j=h.update(V(i,e).ba());if(s(j)){za("transaction failed: Data returned ",j);var l=V(d.g.K,e).k();W(i,e,Q(j,l)),md(d.P,e,[e]),h.status=1,e=I(d.ac,e),i=e.i()||[],i.push(h),J(e,i),xd(d)}else h.dc(),h.F&&(d=vd(d,e),h.F(n,d))},Y.prototype.transaction=Y.prototype.transaction,Y.prototype.uc=function(a,b){A("Firebase.setPriority",1,2,arguments.length),Ga("Firebase.setPriority",this.path),Ca("Firebase.setPriority",1,a,n),D("Firebase.setPriority",2,b,k),a!==m&&Ha.test(a)&&(a=Number(a)),this.n.uc(this.path,a,b)},Y.prototype.setPriority=Y.prototype.uc,Y.prototype.push=function(a,b){A("Firebase.push",0,2,arguments.length),Ga("Firebase.push",this.path),ya("Firebase.push",a,k),D("Firebase.push",2,b,k);var c=Bd(),c=this.A(c);return"undefined"!=typeof a&&a!==m&&c.set(a,b),c},Y.prototype.push=Y.prototype.push,Y.prototype.Ed=function(){A("Firebase.removeOnDisconnect",0,0,arguments.length),this.n.Zb(this.path,m)},Y.prototype.removeOnDisconnect=Y.prototype.Ed,Y.prototype.Zb=function(a){A("Firebase.setOnDisconnect",1,1,arguments.length),ya("Firebase.setOnDisconnect",a,n),this.n.Zb(this.path,a)},Y.prototype.setOnDisconnect=Y.prototype.Zb,Y.prototype.eb=function(a,b){A("Firebase.auth",1,2,arguments.length),u(a)||g(Error(B("Firebase.auth",1,n)+"must be a valid credential (a string).")),D("Firebase.auth",2,b,k),this.n.eb(a,b)},Y.prototype.auth=Y.prototype.eb,Y.prototype.Ab=function(){this.n.Ab()},Y.prototype.unauth=Y.prototype.Ab,Y.enableLogging=Ob,Y.TEST_HOOKS=$,Y.Context=Z}(),define("firebase",function(a){return function(){return a.Firebase}}(this)),require.config({shim:{underscore:{exports:"_"},backbone:{require:["jquery","underscore"],exports:"Backbone"},firebase:{exports:"Firebase"}},paths:{jquery:"vendor/jquery.min",firebase:"vendor/firebase",underscore:"components/underscore/underscore-min",backbone:"components/backbone/backbone-min"}}),require(["mduel/game","mduel/keyboard","firebase"],function(a,b,c){var d=new c("https://mduel.firebaseio.com/game/");a.startGame(d)}),define("main",function(){})}();